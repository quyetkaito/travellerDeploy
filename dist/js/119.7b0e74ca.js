"use strict";(self["webpackChunktraveller"]=self["webpackChunktraveller"]||[]).push([[119],{2119:function(t,e,o){o.r(e),o.d(e,{default:function(){return G}});var a=o(3396);const i={class:"location-list"},n={class:"filter"},l={key:0,class:"flex align-center"},c={class:"filter-combo"},s={class:"filter-combo"},r={class:"filter-combo"},u={class:"content-grid"},d={class:"table-container"},h={key:0,class:"m-paging"};function N(t,e,o,N,A,m){const g=(0,a.up)("m-input"),p=(0,a.up)("v-multiselect"),b=(0,a.up)("m-grid"),L=(0,a.up)("m-pagination");return(0,a.wg)(),(0,a.iD)("div",i,[(0,a._)("div",n,[(0,a.Wm)(g,{showLabel:!1,modelValue:A.textSearch,"onUpdate:modelValue":e[0]||(e[0]=t=>A.textSearch=t),onInput:m.searchData,placeholder:"Tìm kiếm"},null,8,["modelValue","onInput"]),(0,a._)("div",{class:"filter-button",onClick:e[1]||(e[1]=t=>m.filterButtonClick(0))},"Miền Bắc"),(0,a._)("div",{class:"filter-button",onClick:e[2]||(e[2]=t=>m.filterButtonClick(1))},"Miền Trung"),(0,a._)("div",{class:"filter-button",onClick:e[3]||(e[3]=t=>m.filterButtonClick(2))},"Miền Nam"),((0,a.wg)(),(0,a.iD)("div",l,[(0,a._)("div",c,[(0,a.Wm)(p,{ref:"province",modelValue:A.provinceValue,"onUpdate:modelValue":e[4]||(e[4]=t=>A.provinceValue=t),options:A.storeProvince,label:"label","close-on-select":!0,clearOnSelect:!0,searchable:!0,placeholder:"Chọn tỉnh",noResultsText:"Không có kết quả",noOptionsText:"Không có dữ liệu",canClear:!1,canDeselect:!1,onSelect:m.comboProvinceSelected,onOpen:m.comboProvinceBeforeExpand},null,8,["modelValue","options","onSelect","onOpen"])]),(0,a._)("div",s,[(0,a.Wm)(p,{ref:"district",modelValue:A.districtValue,"onUpdate:modelValue":e[5]||(e[5]=t=>A.districtValue=t),options:A.storeDistrict,label:"label","close-on-select":!0,clearOnSelect:!0,searchable:!0,placeholder:"Chọn huyện",noResultsText:"Không có kết quả",noOptionsText:"Không có dữ liệu",canClear:!1,canDeselect:!1,onSelect:m.comboDistrictSelected,onOpen:m.comboDistrictBeforeExpand},null,8,["modelValue","options","onSelect","onOpen"])]),(0,a._)("div",r,[(0,a.Wm)(p,{ref:"ward",modelValue:A.wardValue,"onUpdate:modelValue":e[6]||(e[6]=t=>A.wardValue=t),options:A.storeWard,label:"label","close-on-select":!0,clearOnSelect:!0,searchable:!0,placeholder:"Chọn xã",noResultsText:"Không có kết quả",noOptionsText:"Không có dữ liệu",canClear:!1,canDeselect:!1,onSelect:m.comboWardSelected,onOpen:m.comboWardBeforeExpand},null,8,["modelValue","options","onSelect","onOpen"])])]))]),(0,a._)("div",u,[(0,a._)("div",d,[(0,a.Wm)(b,{listData:A.storeLocation,columns:t.columns,onDblClick:m.handleDoubleClick,tableFunction:t.tableFunction,onEMainButtonClick:m.handleFunctionClick,onEDoubleClick:m.handleDoubleClick,multiSelect:!1},null,8,["listData","columns","onDblClick","tableFunction","onEMainButtonClick","onEDoubleClick"])]),A.showPaging?((0,a.wg)(),(0,a.iD)("div",h,[(0,a.Wm)(L,{totalPage:A.totalPage,currentPage:A.pageNumber,pageSize:A.pageSize,onChangeCurrentPage:m.setCurrentPage},null,8,["totalPage","currentPage","pageSize","onChangeCurrentPage"])])):(0,a.kq)("",!0)])])}o(6699);var A=o(4806),m=o.n(A),g=o(2482),p=o(1181),b=o(2091);class L extends b.Z{constructor(){super(),(0,g.Z)(this,"urlName",p.Z.location)}}var C=new L;class f{constructor(){(0,g.Z)(this,"bacLocation",["LAOCAI","YENBAI","DIENBIEN","HOABINH","LAICHAU","SONLA","HAGIANG","CAOBANG","BACKAN","LANGSON","TUYENQUANG","THAINGUYEN","PHUTHO","BACGIANG","QUANGNINH","BACNINH","HANAM","HANOI","HAIDUONG","HAIPHONG","HUNGYEN","NAMDINH","NINHBINH","THAIBINH","VINHPHUC"]),(0,g.Z)(this,"trungLocation",["THANHHOA","NGHEAN","HATINH","QUANGBINH","QUANGTRI","THUATHIENHUE","KONTUM","GIALAI","DAKLAK","DAKNONG","LAMDONG","DANANG","QUANGNAM","QUANGNGAI","BINHDINH","PHUYEN","KHANHHOA","NINHTHUAN","BINHTHUAN"]),(0,g.Z)(this,"namLocation",["LONGAN","DONGTHAP","TIENGIANG","ANGIANG","BENTRE","VINHLONG","TRAVINH","HAUGIANG","KIENGIANG","SOCTRANG","BACLIEU","CAMAU","CANTHO","HCM","BINHPHUOC","BINHDUONG","DONGNAI","TAYNINH","BARIAVUNGTAU"])}}var H=new f;const I="myDB",D="locations";var S={data(){return{textSearch:null,storeLocation:[],storeLocationAll:[],db:null,locations:[],pageNumber:1,pageSize:10,totalPage:0,showPaging:!0,provinceValue:null,storeProvince:[],districtValue:null,storeDistrict:[],wardValue:null,storeWard:[]}},created(){this.initStaticData()},mounted(){var t=window.indexedDB.open(I,1);t.onsuccess=async e=>{this.db=t.result,await this.getCacheLocation()},t.onupgradeneeded=t=>{this.db=t.target.result,this.db.createObjectStore(D,{autoIncrement:!0})}},methods:{comboProvinceBeforeExpand(){},comboProvinceSelected(t){this.districtValue=null,this.wardValue=null},comboDistrictBeforeExpand(){if(this.provinceValue){let t=this.storeLocationAll.find((t=>t.location_name==this.provinceValue))?.location_code;this.storeDistrict=this.storeLocationAll.filter((e=>e.parent_code==t)).map((t=>t.location_name))}},comboDistrictSelected(){this.wardValue=null},comboWardBeforeExpand(){if(this.districtValue){let t=this.storeLocationAll.find((t=>t.location_name==this.districtValue))?.location_code;this.storeWard=this.storeLocationAll.filter((e=>e.parent_code==t)).map((t=>t.location_name))}},comboWardSelected(){},filterButtonClick(t){if(null!=t){let e=[];switch(t){case 0:e=H.bacLocation,this.storeLocation=this.storeLocationAll.filter((t=>e.includes(t.location_code))),this.showPaging=!1;break;case 1:e=H.trungLocation,this.storeLocation=this.storeLocationAll.filter((t=>e.includes(t.location_code))),this.showPaging=!1;break;case 2:e=H.namLocation,this.storeLocation=this.storeLocationAll.filter((t=>e.includes(t.location_code))),this.showPaging=!1;break;default:break}}},setCurrentPage(t){this.pageNumber!=t&&(this.pageNumber=t,this.filterData(this.pageNumber))},filterData(t){if(this.textSearch){let e=this.textSearch.toLowerCase();this.storeLocation=this.storeLocationAll.filter(((o,a)=>a>=(t-1)*this.pageSize&&a<t*this.pageSize&&(o.location_code.toLowerCase().includes(e)||o.location_name.toLowerCase().includes(e)))),this.showPaging=!0}else this.storeLocation=this.storeLocationAll.filter(((e,o)=>o>=(t-1)*this.pageSize&&o<t*this.pageSize)),this.showPaging=!0},async getCacheLocation(){this.locations=[];var t=await this.db.transaction(D).objectStore(D);let e=t.get("locations");e.onsuccess=()=>{e.result&&e.result.length>0?(this.storeLocation=e.result.filter(((t,e)=>e<10)),this.storeLocationAll=e.result,this.totalPage=Math.round(this.storeLocationAll.length/10),this.initDataLocation()):this.getFreshLocation()}},async addLocation(t){var e=await this.db.transaction(D,"readwrite").objectStore(D).add(t,"locations");e.onsuccess=t=>{this.getCacheLocation()}},searchData:m().debounce((function(){let t=this;if(t.textSearch){let e=t.textSearch.toLowerCase();t.storeLocation=t.storeLocationAll.filter((t=>t.location_code.toLowerCase().includes(e)||t.location_name.toLowerCase().includes(e)))}else t.storeLocation=t.storeLocationAll.filter((e=>t.storeLocationAll.indexOf(e)<10))}),1e3),handleFunctionClick(t){let e=this;if(t)switch(e.tableFunction.mainFunction){case"Edit":}},handleDoubleClick(){},async initStaticData(){let t=this;t.tableFunction={mainButtonText:"Sửa",mainFunction:"Edit",isShow:!1},t.columns=[{title:"Tên địa điểm",key:"location_name",width:200},{title:"Mã",key:"location_code",width:200}]},async getFreshLocation(){let t=this,e=await C.request(C.urlName,"get");e&&e.data&&e.data.length>0&&(t.storeLocation=e.data.filter((t=>null==t.parent_code)),t.storeLocationAll=e.data,this.addLocation(e.data),this.totalPage=Math.round(this.storeLocationAll.length/10),this.initDataLocation())},initDataLocation(){this.storeLocationAll&&this.storeLocationAll.length>0&&(this.storeProvince=this.storeLocationAll.filter((t=>null==t.parent_code)).map((t=>t.location_name)))}}},w=o(89);const v=(0,w.Z)(S,[["render",N]]);var G=v}}]);
//# sourceMappingURL=119.7b0e74ca.js.map