"use strict";(self["webpackChunktraveller"]=self["webpackChunktraveller"]||[]).push([[229],{2106:function(e,t,r){var a=r(2482),l=r(1181),n=r(2091);class s extends n.Z{constructor(){super(),(0,a.Z)(this,"urlName",l.Z.user)}}t["Z"]=new s},2229:function(e,t,r){r.r(t),r.d(t,{default:function(){return B}});var a=r(3396),l=r(7139);const n=e=>((0,a.dD)("data-v-6dcdbede"),e=e(),(0,a.Cn)(),e),s={class:"userinfo-container flex"},i={class:"w-1/3 overview"},o={class:"flex align-x-center"},m={class:"user-avatar mt-10 rounded-full"},u=["src"],d={class:"name flex align-x-center mt-4"},c={class:"w-2/3 info-detail"},f={class:"form-title flex align-y-center"},h=n((()=>(0,a._)("div",{class:"mr-10 title"},"Thông tin cá nhân",-1))),v={class:"btn-save"},g={class:"m-form-field"},_={class:"form-item",style:{width:"50%","margin-right":"10px"}},I={class:"form-item",style:{width:"50%"}},p={class:"m-form-field"},y={class:"form-item",style:{width:"100%"}},b={class:"m-form-field"},w={class:"form-item",style:{"padding-right":"6px",width:"40%"}},V={class:"form-item",style:{width:"60%","padding-left":"6px"}},x={class:"mt-3 m-field-gender"},$={class:"m-form-field"},A={class:"form-item",style:{width:"100%"}};function U(e,t,r,n,U,T){const N=(0,a.up)("m-button"),k=(0,a.up)("m-input"),D=(0,a.up)("m-label"),S=(0,a.up)("v-date-picker"),W=(0,a.up)("m-radio");return(0,a.wg)(),(0,a.iD)("div",s,[(0,a._)("div",i,[(0,a._)("div",o,[(0,a._)("div",m,[(0,a._)("input",{type:"file",style:{display:"none"},id:"choose-avt",ref:"chooseAvt",onChange:t[0]||(t[0]=(...e)=>T.changeAvatar&&T.changeAvatar(...e))},null,544),(0,a._)("img",{id:"userAvatar",ref:"userAvatar",src:U.imgSrc,alt:"",class:"rounded-full",onClick:t[1]||(t[1]=(...e)=>T.chooseAvatar&&T.chooseAvatar(...e))},null,8,u)])]),(0,a._)("div",d,(0,l.zw)(U.currentItem.full_name),1)]),(0,a._)("div",c,[(0,a._)("div",f,[h,(0,a._)("div",v,[(0,a.Wm)(N,{text:e.$t("Save"),type:U.typeButton,onClick:T.saveInfo},null,8,["text","type","onClick"])])]),(0,a._)("div",g,[(0,a._)("div",_,[(0,a.Wm)(k,{labelText:e.$t("Email"),modelValue:U.currentItem.email,"onUpdate:modelValue":t[2]||(t[2]=e=>U.currentItem.email=e),readonly:!0,isAutoFocus:!0,maxlength:20,placeholder:"",style:{width:"100%"},ref:"email"},null,8,["labelText","modelValue"])]),(0,a._)("div",I,[(0,a.Wm)(k,{labelText:e.$t("Phone"),modelValue:U.currentItem.phone,"onUpdate:modelValue":t[3]||(t[3]=e=>U.currentItem.phone=e),readonly:U.isViewing,isAutoFocus:!0,maxlength:20,placeholder:"",style:{width:"100%"},ref:"email"},null,8,["labelText","modelValue","readonly"])])]),(0,a._)("div",p,[(0,a._)("div",y,[(0,a.Wm)(k,{labelText:e.$t("FullName"),modelValue:U.currentItem.full_name,"onUpdate:modelValue":t[4]||(t[4]=e=>U.currentItem.full_name=e),readonly:U.isViewing,isAutoFocus:!0,maxlength:20,placeholder:"",style:{width:"100%"},ref:"email"},null,8,["labelText","modelValue","readonly"])])]),(0,a._)("div",b,[(0,a._)("div",w,[(0,a.Wm)(D,{text:"Ngày sinh"}),(0,a.Wm)(S,{value:U.currentItem.date_of_birth,"onUpdate:value":t[5]||(t[5]=e=>U.currentItem.date_of_birth=e),format:e.$store.state.dateFormat,placeholder:e.$store.state.dateFormat,lang:e.$store.state.langString,"disabled-date":T.disabledDateBeforeToday,clearable:!1,"title-format":"DD/MM/YYYY"},null,8,["value","format","placeholder","lang","disabled-date"])]),(0,a._)("div",V,[(0,a.Wm)(D,{text:"Giới tính"}),(0,a._)("div",x,[(0,a.Wm)(W,{modelValue:U.currentItem.gender,"onUpdate:modelValue":t[6]||(t[6]=e=>U.currentItem.gender=e),value:1,label:"Nam"},null,8,["modelValue"]),(0,a.Wm)(W,{modelValue:U.currentItem.gender,"onUpdate:modelValue":t[7]||(t[7]=e=>U.currentItem.gender=e),value:0,label:"Nữ"},null,8,["modelValue"]),(0,a.Wm)(W,{modelValue:U.currentItem.gender,"onUpdate:modelValue":t[8]||(t[8]=e=>U.currentItem.gender=e),value:2,label:"Khác"},null,8,["modelValue"])])])]),(0,a._)("div",$,[(0,a._)("div",A,[(0,a.Wm)(k,{labelText:"Địa chỉ",maxlength:255,readonly:U.isViewing,modelValue:U.currentItem.address,"onUpdate:modelValue":t[9]||(t[9]=e=>U.currentItem.address=e),placeholder:"",style:{width:"100%"},ref:"address"},null,8,["readonly","modelValue"])])])])])}var T=r(2106),N=r(3332),k=(r(533),r(1992)),D=r(3029);const S=(0,k.cF)();var W={components:{"v-date-picker":N["default"]},data(){return{currentItem:{},isViewing:!1,originalItem:{},typeButton:"info",imgSrc:""}},created(){this.getUserInfo()},mounted(){this.imgSrc=this.currentItem.user_avatar_img?this.currentItem.user_avatar_img:r(4472)},beforeRouteLeave(e,t,r){let a=this;a.$commonFunc.isDeepEqual(a.currentItem,a.originalItem)||confirm("bạn chưa lưu, có muốn chuyển không?")?r():r(!1)},methods:{changeAvatar(e){let t=this;const r={contentType:"image/jpeg"};if(t.$commonFunc.validateInputImage(e.target)){const a=(0,k.iH)(S,`image/${(0,D.Z)()}.jpeg`);(0,k.KV)(a,e.target.files[0],r).then((()=>{(0,k.Jt)(a).then((e=>{document.getElementById("userAvatar").style.display="block",document.getElementById("userAvatar").src=e,t.$store.state.userAvatar=e,t.currentItem.user_avatar_img=e}))}))}},chooseAvatar(){let e=this;e.$refs.chooseAvt&&e.$refs.chooseAvt.click()},disabledDateBeforeToday(e){return e>new Date},async saveInfo(){let e=this;if(e.currentItem&&this.currentItem.user_id){e.currentItem.date_of_birth=e.$commonFunc.setTimeZone(e.currentItem.date_of_birth);let t=await T.Z.request(T.Z.urlName,"PUT",this.currentItem);t&&t.data?(e.$store.commit("showInfo",{message:t.data.UserMsg,timeout:1200}),e.typeButton="gray",e.currentItem.date_of_birth=new Date(e.currentItem.date_of_birth),e.$session.set("UserAvatar",e.currentItem.user_avatar_img)):e.$store.commit("showError",{message:t.data.UserMsg,timeout:1200})}},async getUserInfo(){try{let e=this,t=e.$session.get("UserInfo");if(t)e.currentItem=t,e.currentItem.hasOwnProperty("date_of_birth")&&(e.currentItem.date_of_birth=new Date(e.currentItem.date_of_birth)),e.currentItem.user_avatar_img&&(this.$refs.userAvatar&&(this.$refs.userAvatar.src=e.currentItem.user_avatar_img),e.$store.state.userAvatar=e.currentItem.user_avatar_img),e.originalItem=JSON.parse(JSON.stringify(e.currentItem));else{let t=e.$session.get("UserID");if(t){let r=await T.Z.request(T.Z.urlName+`/${t}`,"GET");r&&r.data&&(e.$session.set("UserInfo",r.data),e.currentItem=JSON.parse(JSON.stringify(r.data)),e.currentItem.hasOwnProperty("date_of_birth")&&(e.currentItem.date_of_birth=new Date(e.currentItem.date_of_birth)),e.currentItem.user_avatar_img&&(document.getElementById("userAvatar").src=e.currentItem.user_avatar_img,e.$store.state.userAvatar=e.currentItem.user_avatar_img),e.originalItem=JSON.parse(JSON.stringify(e.currentItem)))}}}catch(e){console.error(e)}}}},Z=r(89);const F=(0,Z.Z)(W,[["render",U],["__scopeId","data-v-6dcdbede"]]);var B=F}}]);
//# sourceMappingURL=229.35c83d63.js.map