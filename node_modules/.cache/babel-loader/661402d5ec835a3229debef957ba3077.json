{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\n// import vClickOutside from \"click-outside-vue3\";\nimport * as base from \"@/script/base\";\nexport default {\n  component: {},\n  emits: [\"eUpdate\", \"onDelete\", \"eDoubleClick\", \"eClick\", \"eShowFunc\", \"handleHideFunc\", \"eMultiSelect\", \"eMainButtonClick\" //button chính của function click\n  ],\n  //config của thư viện v-click-outside\n  // directives: {\n  //   clickOutside: vClickOutside.directive,\n  // },\n  //danh sách các prop\n  props: {\n    //list data render ra bảng\n    listData: {\n      type: Object,\n      default: null,\n      required: true //bắt buộc có\n\n    },\n    //list các column của bảng\n    columns: {\n      type: Array,\n      //mảng các object cột\n      default: null,\n      required: true //bắt buộc\n\n    },\n    //số bản ghi trên một trang\n    pageSize: {\n      type: [Number, String],\n      default: null\n    },\n    //loading skeleton có show hay không?\n    isShowSkeleton: {\n      type: Boolean,\n      default: false\n    },\n    //cấu hình cột chức năng\n    tableFunction: {\n      type: Object,\n\n      default() {\n        return {\n          mainButtonText: 'Edit',\n          mainFunction: \"Edit\",\n          isShow: true\n        };\n      }\n\n    },\n    //có cột checkbox hay không?\n    multiSelect: {\n      type: Boolean,\n      default: true\n    },\n    //các hàng có thể kéo thả để thay đổi vị trí không?\n    isDragable: {\n      type: Boolean,\n      default: false\n    },\n    //bảng này có hiện header không?\n    isHasHeader: {\n      type: Boolean,\n      default: true\n    },\n    //footer có show không?\n    showFooter: {\n      type: Boolean,\n      default: false\n    },\n    //icon loading có show không?\n    isShowLoading: {\n      type: Boolean,\n      default: false\n    }\n  },\n\n  //danh sách các data\n  data() {\n    return {\n      isCheckAll: false,\n      //nút check all có đang check hay không?\n      checkedRows: [] //số hàng đang được chọn => (mảng các object)\n\n    };\n  },\n\n  mounted() {},\n\n  watch: {\n    /**----------------------------------------------------------\r\n     * nếu checkedRows thay đổi thì cập nhật lại các hàng dc select\r\n     * Author: quyetkaito (14/03/2022)\r\n     ---------------------------------*/\n    checkedRows() {\n      this.changeSelected();\n    },\n\n    /**--------------------------------------\r\n     * Nếu đang hiện skeleton thì bỏ check tất cả.\r\n     * Author: quyetkaito (22/-3/2022)\r\n     ---------------------------------*/\n    isShowSkeleton() {\n      this.checkedRows = [];\n    }\n\n  },\n  //các hàm\n  methods: {\n    /**\r\n     * Trả về source của image bind động\r\n     * @param src : tên file/ link ảnh\r\n     * @param ext : đuôi file\r\n     * @param type : loại source\r\n     */\n    getImageSrc(src, format, type = 'local') {\n      try {\n        src = src.toString(); //chuyển về string cho chắc\n\n        if (type == 'link') {\n          //nếu type là link thì trả về link luôn\n          return src;\n        }\n\n        switch (format) {\n          case 'webp':\n            return require(`@/assets/${src}.webp`);\n          //phải viết sẵn như này mới ăn, viết kiểu + string thì chết\n\n          case 'png':\n            return require(`@/assets/${src}.png`);\n\n          default:\n            return null;\n        }\n      } catch (error) {\n        console.log(error);\n        return null;\n      }\n    },\n\n    /**------------------------------------------\r\n    * Xử lý khi button chính trong cột chức năng được click\r\n    * @created : quyetkaito (26/06/2022)\r\n    * @param {Object} object - hàng chứa thông tin đối tượng được click\r\n    ---------------------------------------------*/\n    mainButtonClick(object) {\n      if (object) {\n        this.$emit(\"eMainButtonClick\", object);\n      }\n    },\n\n    /**------------------------------------------\r\n    * Xử lý khi double click vào hàng\r\n    * @param {Object} object : hàng chứa thông tin đối tượng\r\n    * @created : quyetkaito (26/06/2022)\r\n    --------------------------------------------*/\n    handleDoubleClick(object) {\n      if (object) {\n        this.$emit(\"eDoubleClick\", object);\n      }\n    },\n\n    /**---------------------------------------------\r\n     * Thực hiện bỏ dấu checkAll sau khi xóa nhiều.\r\n     * Author: quyetkaito (18/03/2022)\r\n     ---------------------------------*/\n    unCheckAll() {\n      if (this.$refs.selectAll.checked == true) this.$refs.selectAll.checked = false;\n    },\n\n    /**-----------------------------------\r\n     * Hàm show data tương ứng với các cột của header.\r\n     * @param {String} object - object hàng hiện tại.\r\n     * @param {String} column - cấu hình của cột hiện tại\r\n     * Author: quyetkaito (16/03/2022)\r\n     ------------------------------------*/\n    showData(object, column) {\n      //chuyển column key sang snake_case (nếu cần)\n      if (column.key && object) {\n        let objTemp = JSON.parse(JSON.stringify(object));\n        let field = base.camelToUnderscore(column.key); //nếu dữ liệu dạng số\n\n        if (column.dataType && column.dataType == \"number\") {\n          if (objTemp[field]) {\n            return base.formatCurrency(objTemp[field].toString());\n          }\n        } //nếu dữ liệu là ngày tháng\n\n\n        if (column.dataType && column.dataType == \"date\") {\n          return !base.formatDate(objTemp[field], this.$enum.DateFormat).includes('NaN') ? base.formatDate(objTemp[field], this.$enum.DateFormat) : \"\";\n        } //nếu không => trả về data với field tương ứng từ header(dạng text bình thường)\n\n\n        return objTemp[field] ? objTemp[field] : \"\";\n      }\n\n      return \"\";\n    },\n\n    /**----------------------------------------------\r\n     * Hàm emit tới cha danh sách các hàng được chọn.\r\n     * Author: quyetkaito (15/03/2022)\r\n    ------------------------------------*/\n    changeSelected() {\n      // console.log(this.checkedRows);\n      //emit tới cha danh sách đối tượng\n      this.$emit(\"eMultiSelect\", this.checkedRows);\n    },\n\n    /**-------------------------------------------------\r\n     * Hàm xử lý khi click vào nút [Sửa] trên bảng.\r\n     * @param {Object} obj - đối tượng thao tác\r\n     * @param {Number} formMode - trạng thái của form\r\n     * Author: quyetkaito (27/02/2022)\r\n     -----------------------------------------------*/\n    handleEdit(obj) {\n      //emit tới cha nhận sự kiện update\n      this.$emit(\"eUpdate\", {\n        data: obj,\n        formMode: 2\n      }); //emit tới cha đóng function\n\n      this.$emit(\"handleHideFunc\");\n    },\n\n    /**------------------------------------------\r\n    *Xử lý khi 1 hàng được click\r\n    *Author: quyetkaito (13/04/2022)\r\n    --------------------------------------------*/\n    handleClick(object, index) {\n      try {\n        //emit tới cha đối tượng được click\n        this.$emit(\"eClick\", {\n          object,\n          index\n        }); //xóa background cho tất cả các hàng khác, giữ lại hàng đang được click\n\n        this.$refs.mTable.querySelectorAll(`tbody tr`).forEach(e => {\n          e.classList.remove(\"selected\");\n        });\n        this.$refs.mTable.querySelector(`tbody tr:nth-child(${index + 1})`).classList.add(\"selected\");\n      } catch (error) {\n        //log ra lỗi\n        console.log(error);\n      }\n    },\n\n    /**------------------------------------------------\r\n         * Hàm xử lý khi click vào nút [Xóa] trên bảng.\r\n         * @param {Object} obj - đối tượng cần xóa.\r\n         * Author: quyetkaito (27/02/2022)\r\n         ----------------------------------------------*/\n    handleDelete(obj) {\n      this.$emit(\"onDelete\", obj);\n    },\n\n    /**------------------------------------------------------\r\n     * Hàm thực hiện lấy vị trí click để hiện dropdown content.\r\n     * @param {Object} object - đối tượng ứng với hàng.\r\n     * @param {Event} event\r\n     * @param {Number} index - số thứ tự của hàng được chọn\r\n     * Author: quyetkaito (07/03/2022)\r\n     -----------------------------------------------------------*/\n    showOptions(event, object, index) {\n      // console.log(index);\n      // console.log(this.$refs.dropdownArrow[index]);\n      //lấy ra arrow tại hàng đó\n      let arrow = this.$refs.dropdownArrow[index]; //lấy ra vị trí của arrow\n\n      let arrowPosition = arrow.getBoundingClientRect(); //emit tới cha show dropdowncontent hiện tại\n\n      this.$emit(\"eShowFunc\", {\n        object,\n        arrowPosition\n      });\n    },\n\n    /**------------------------------------------------\r\n     * Xử lý đóng table Function khi click ra ngoài bảng\r\n     * Author: quyetkaito (13/03/2022)\r\n    -------------------------------------*/\n    hideOptions() {\n      //emit tới cha ẩn dropdowncontent hiện tại\n      this.$emit(\"handleHideFunc\");\n    },\n\n    /**------------------------------------------\r\n    *CSS cho những hàng đang được chọn\r\n    *@param {Object} selectedRow - hàng đang chọn.\r\n    selectedRow, value\r\n    *Author: quyetkaito (15/04/2022)\r\n    --------------------------------------------*/\n    addSelectedRow(index) {\n      if (this.listData.length > 0) {\n        let allRow = this.$el.querySelectorAll(`tbody tr`);\n        let thisRow = this.$el.querySelector(`tbody tr:nth-child(${index + 1})`);\n\n        if (allRow) {\n          //xóa background cho tất cả các hàng khác, giữ lại hàng đang được click\n          allRow.forEach(e => {\n            e.classList.remove(\"selected\");\n          });\n          if (thisRow) thisRow.classList.add(\"selected\");\n        }\n      }\n    },\n\n    /**------------------------------------------\r\n    *Hàm lấy thông tin 1 hàng của table.\r\n    *@param {Number} index số thứ tự hàng, bắt đầu từ 0\r\n    *Author: quyetkaito (01/05/2022)\r\n    --------------------------------------------*/\n    getRow(index) {\n      return this.listData[index];\n    }\n\n  },\n\n  /**------------------------------------------\r\n  *Tính toán data trong grid.\r\n  *Author: quyetkaito (09/04/2022)\r\n  --------------------------------------------*/\n  computed: {\n    /**-------------------------------------\r\n     * Thực hiện chọn tất cả/ bỏ chọn tất cả\r\n     * Author: quyetkaito (14/03/2022)\r\n     ---------------------------------*/\n    selectAll: {\n      get: function () {\n        //trả về true nếu listData = số hàng được check, false ngược lại\n        return this.listData ? this.checkedRows.length == this.listData.length && this.listData.length != 0 : false;\n      },\n      //select All\n      set: function (value) {\n        var selected = [];\n\n        try {\n          if (value) {\n            console.log(value); //tạo danh sách các đối tượng được chọn\n\n            this.listData.forEach(function (data) {\n              selected.push(data);\n            });\n          }\n\n          this.checkedRows = selected;\n        } catch (error) {\n          this.checkedRows = selected;\n          console.log(error);\n        }\n      }\n    },\n\n    /**------------------------------\r\n     * Tính toán số lượng các cột skeleton.\r\n     * Author: quyetkaito (27/03/2022)\r\n     --------------------------------*/\n    columnSkeleton() {\n      if (this.multiSelect) {\n        return this.columns.length + 2;\n      } else {\n        return this.columns.length + 1;\n      }\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["base","component","emits","props","listData","type","Object","default","required","columns","Array","pageSize","Number","String","isShowSkeleton","Boolean","tableFunction","mainButtonText","mainFunction","isShow","multiSelect","isDragable","isHasHeader","showFooter","isShowLoading","data","isCheckAll","checkedRows","mounted","watch","changeSelected","methods","getImageSrc","src","format","toString","require","error","console","log","mainButtonClick","object","$emit","handleDoubleClick","unCheckAll","$refs","selectAll","checked","showData","column","key","objTemp","JSON","parse","stringify","field","camelToUnderscore","dataType","formatCurrency","formatDate","$enum","DateFormat","includes","handleEdit","obj","formMode","handleClick","index","mTable","querySelectorAll","forEach","e","classList","remove","querySelector","add","handleDelete","showOptions","event","arrow","dropdownArrow","arrowPosition","getBoundingClientRect","hideOptions","addSelectedRow","length","allRow","$el","thisRow","getRow","computed","get","set","value","selected","push","columnSkeleton"],"sourceRoot":"","sources":["D:\\Traveller\\Traveller-Frontend\\traveller-ui\\src\\components\\m-grid\\MGrid.vue"],"sourcesContent":["<template>\r\n  <table ref=\"mTable\" class=\"m-table\">\r\n    <!-- Table Header -->\r\n    <thead v-if=\"isHasHeader\">\r\n      <tr>\r\n        <th v-if=\"isDragable\" class=\"w-50\"></th>\r\n        <th v-if=\"multiSelect\">\r\n          <div class=\"m-checkbox\">\r\n            <input type=\"checkbox\" v-model=\"selectAll\" ref=\"selectAll\" />\r\n          </div>\r\n        </th>\r\n        <!-- Lấy tên các header để render ra -->\r\n        <th\r\n          v-for=\"(header, index) in columns\"\r\n          :key=\"index\"\r\n          :style=\"`width:${header.width}px!important;min-width:${header.width}px!important;`\"\r\n        >\r\n          <div :title=\"header.titleFull\" :style=\"`justify-content: ${header.titleAlign}`\" v-if=\"header.visible = true\">\r\n            {{ header.title }}\r\n          </div>\r\n        </th>\r\n        <th v-if=\"tableFunction.isShow\">\r\n          <div class=\"justify-end\">chức năng</div>\r\n        </th>\r\n      </tr>\r\n    </thead>\r\n\r\n    <!-- Table Body -->\r\n    <tbody v-if=\"listData.length !== 0\">\r\n      <tr\r\n        v-for=\"(object, index) in listData\"\r\n        :key=\"index\"\r\n        @dblclick=\"handleDoubleClick(object)\"\r\n        @click=\"handleClick(object, index)\"\r\n      >\r\n        <td v-if=\"isDragable\" class=\"w-50\">\r\n          <div class=\"m-icon m-icon-16 m-drag-grid\"></div>\r\n        </td>\r\n        <td v-if=\"multiSelect\" class=\"w-50\">\r\n          <div class=\"m-checkbox\">\r\n            <input\r\n              type=\"checkbox\"\r\n              v-model=\"checkedRows\"\r\n              :value=\"object\"\r\n              @change=\"handleCheckboxChange\"\r\n            />\r\n          </div>\r\n        </td>\r\n        <td\r\n          v-for=\"(column, idx) in columns\"\r\n          :key=\"idx\"\r\n          :style=\"`width:${column.width}px!important;min-width:${column.width}px!important;max-width:300px!important;`\"\r\n        >\r\n          <div :style=\"`justify-content: ${column.titleAlign}`\" v-if=\"column.visible = true && column.dataType != 'image'\">\r\n            <!-- {{ column.width }} -->\r\n            {{ showData(object, column) }}\r\n          </div>\r\n          <div :style=\"`justify-content: ${column.titleAlign}`\" v-if=\"column.visible = true && column.dataType == 'image'\">            \r\n              <img :src=\"getImageSrc(object.src, object.format, object.type)\" :alt=\"object.imgAlt\" :width=\"object.imgWidth?object.imgWidth:50\" :height=\"object.imgHeight?object.imgHeight:50\"/>\r\n          </div>\r\n        </td>\r\n        <td v-if=\"tableFunction.isShow\">\r\n          <!-- table function -->\r\n          <div class=\"m-table-tool flex align-y-center justify-end\">\r\n            <div class=\"m-table-tool__text\" @click=\"mainButtonClick(object)\">\r\n              <button class=\"tool-btn\">{{ tableFunction.mainButtonText }}</button>\r\n            </div>\r\n            <div ref=\"dropdownArrow\" class=\"m-table-tool__icon\">\r\n              <div\r\n                class=\"line flex align-center\"\r\n                @click=\"showOptions($event, object, index)\"\r\n                @doubleClick=\"handleEdit(object)\"\r\n              >\r\n                <div class=\"m-icon m-icon-16 m-arrow-up--blue\"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <!-- /table function -->\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n    <!-- Table body skeleton -->\r\n    <tbody v-if=\"isShowSkeleton && listData.length == 0\" class=\"empty\">\r\n      <tr v-for=\"i in pageSize\" v-bind:key=\"i\">\r\n        <td v-for=\"col in columnSkeleton\" :key=\"col\"><div></div></td>\r\n      </tr>\r\n    </tbody>\r\n    <!-- Ảnh không có dữ liệu -->\r\n    <tbody v-if=\"!isShowSkeleton && listData.length == 0\" class=\"empty\">\r\n      Không có dữ liệu\r\n    </tbody>\r\n    <!-- Table Footer -->\r\n    <tfoot v-if=\"showFooter && listData.length !== 0\" class=\"m-table-footer\">\r\n      <tr>\r\n        <th v-if=\"isDragable\" class=\"w-50\"></th>\r\n        <th v-if=\"multiSelect\" class=\"w-50\"></th>\r\n        <th\r\n          v-for=\"(column, index) in columns\"\r\n          :key=\"index\"\r\n          :style=\"`width:${column.width}px!important;min-width:${column.width}px!important;`\"\r\n        >\r\n          <div v-if=\"index == 0\" class=\"align-center\">Tổng</div>\r\n          <div :class=\"column.align\" v-if=\"index != 0\">\r\n            {{ column.total_amount }}\r\n          </div>\r\n        </th>\r\n        <th v-if=\"isHasFunctionColumn\"></th>\r\n      </tr>\r\n    </tfoot>\r\n  </table>\r\n</template>\r\n\r\n<script>\r\n// import vClickOutside from \"click-outside-vue3\";\r\nimport * as base from \"@/script/base\";\r\n\r\nexport default {\r\n  component: {},\r\n  emits: [\r\n    \"eUpdate\",\r\n    \"onDelete\",\r\n    \"eDoubleClick\",\r\n    \"eClick\",\r\n    \"eShowFunc\",\r\n    \"handleHideFunc\",\r\n    \"eMultiSelect\",\r\n    \"eMainButtonClick\",//button chính của function click\r\n  ],\r\n  //config của thư viện v-click-outside\r\n  // directives: {\r\n  //   clickOutside: vClickOutside.directive,\r\n  // },\r\n\r\n  //danh sách các prop\r\n  props: {\r\n    //list data render ra bảng\r\n    listData: {\r\n      type: Object,\r\n      default: null,\r\n      required: true, //bắt buộc có\r\n    },\r\n    //list các column của bảng\r\n    columns: {\r\n      type: Array, //mảng các object cột\r\n      default: null,\r\n      required: true, //bắt buộc\r\n    },\r\n    //số bản ghi trên một trang\r\n    pageSize: {\r\n      type: [Number, String],\r\n      default: null,\r\n    },\r\n    //loading skeleton có show hay không?\r\n    isShowSkeleton: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    //cấu hình cột chức năng\r\n    tableFunction:{\r\n      type: Object,\r\n      default(){\r\n        return{        \r\n          mainButtonText : 'Edit',\r\n          mainFunction: \"Edit\",\r\n          isShow: true\r\n        }\r\n      }\r\n    },\r\n    //có cột checkbox hay không?\r\n    multiSelect: {\r\n      type: Boolean,\r\n      default: true,\r\n    },\r\n    //các hàng có thể kéo thả để thay đổi vị trí không?\r\n    isDragable: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    //bảng này có hiện header không?\r\n    isHasHeader: {\r\n      type: Boolean,\r\n      default: true,\r\n    },\r\n    //footer có show không?\r\n    showFooter: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    //icon loading có show không?\r\n    isShowLoading: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n  },\r\n\r\n  //danh sách các data\r\n  data() {\r\n    return {\r\n      isCheckAll: false, //nút check all có đang check hay không?\r\n      checkedRows: [], //số hàng đang được chọn => (mảng các object)\r\n    };\r\n  },\r\n  mounted() {},\r\n  watch: {\r\n    /**----------------------------------------------------------\r\n     * nếu checkedRows thay đổi thì cập nhật lại các hàng dc select\r\n     * Author: quyetkaito (14/03/2022)\r\n     ---------------------------------*/\r\n    checkedRows() {\r\n      this.changeSelected();\r\n    },\r\n\r\n    /**--------------------------------------\r\n     * Nếu đang hiện skeleton thì bỏ check tất cả.\r\n     * Author: quyetkaito (22/-3/2022)\r\n     ---------------------------------*/\r\n    isShowSkeleton() {\r\n      this.checkedRows = [];\r\n    },\r\n  },\r\n\r\n  //các hàm\r\n  methods: {\r\n    /**\r\n     * Trả về source của image bind động\r\n     * @param src : tên file/ link ảnh\r\n     * @param ext : đuôi file\r\n     * @param type : loại source\r\n     */\r\n    getImageSrc(src, format, type = 'local'){\r\n      try {\r\n        src = src.toString(); //chuyển về string cho chắc\r\n        if(type == 'link'){ //nếu type là link thì trả về link luôn\r\n          return src;\r\n        }   \r\n        switch (format) {\r\n          case 'webp':\r\n            return require(`@/assets/${src}.webp`);    //phải viết sẵn như này mới ăn, viết kiểu + string thì chết\r\n          case 'png':\r\n            return require(`@/assets/${src}.png`);           \r\n        \r\n          default:\r\n            return null;\r\n        }\r\n      } catch (error) {\r\n        console.log(error)\r\n        return null;\r\n      }\r\n    },\r\n    \r\n    /**------------------------------------------\r\n    * Xử lý khi button chính trong cột chức năng được click\r\n    * @created : quyetkaito (26/06/2022)\r\n    * @param {Object} object - hàng chứa thông tin đối tượng được click\r\n    ---------------------------------------------*/\r\n    mainButtonClick(object){\r\n        if(object){\r\n            this.$emit(\"eMainButtonClick\", object);\r\n        }\r\n    },\r\n\r\n    /**------------------------------------------\r\n    * Xử lý khi double click vào hàng\r\n    * @param {Object} object : hàng chứa thông tin đối tượng\r\n    * @created : quyetkaito (26/06/2022)\r\n    --------------------------------------------*/\r\n    handleDoubleClick(object){\r\n      if(object){\r\n        this.$emit(\"eDoubleClick\", object);\r\n      }\r\n    },\r\n\r\n    /**---------------------------------------------\r\n     * Thực hiện bỏ dấu checkAll sau khi xóa nhiều.\r\n     * Author: quyetkaito (18/03/2022)\r\n     ---------------------------------*/\r\n    unCheckAll() {\r\n      if (this.$refs.selectAll.checked == true)\r\n        this.$refs.selectAll.checked = false;\r\n    },\r\n\r\n    /**-----------------------------------\r\n     * Hàm show data tương ứng với các cột của header.\r\n     * @param {String} object - object hàng hiện tại.\r\n     * @param {String} column - cấu hình của cột hiện tại\r\n     * Author: quyetkaito (16/03/2022)\r\n     ------------------------------------*/\r\n    showData(object, column) {\r\n      //chuyển column key sang snake_case (nếu cần)\r\n      if(column.key && object){\r\n        let objTemp = JSON.parse(JSON.stringify(object));\r\n        let field = base.camelToUnderscore(column.key);\r\n        //nếu dữ liệu dạng số\r\n        if (column.dataType && column.dataType == \"number\") {\r\n          if(objTemp[field]){\r\n            return base.formatCurrency(objTemp[field].toString());\r\n          }\r\n        }\r\n        //nếu dữ liệu là ngày tháng\r\n        if (column.dataType && column.dataType == \"date\") {\r\n          return !base.formatDate(objTemp[field], this.$enum.DateFormat).includes('NaN') ? base.formatDate(objTemp[field], this.$enum.DateFormat) : \"\";\r\n        }\r\n        //nếu không => trả về data với field tương ứng từ header(dạng text bình thường)\r\n        return objTemp[field] ? objTemp[field]: \"\";\r\n      }\r\n      return \"\";\r\n    },\r\n\r\n    /**----------------------------------------------\r\n     * Hàm emit tới cha danh sách các hàng được chọn.\r\n     * Author: quyetkaito (15/03/2022)\r\n    ------------------------------------*/\r\n    changeSelected() {\r\n      // console.log(this.checkedRows);\r\n      //emit tới cha danh sách đối tượng\r\n      this.$emit(\"eMultiSelect\", this.checkedRows);\r\n    },\r\n\r\n    /**-------------------------------------------------\r\n     * Hàm xử lý khi click vào nút [Sửa] trên bảng.\r\n     * @param {Object} obj - đối tượng thao tác\r\n     * @param {Number} formMode - trạng thái của form\r\n     * Author: quyetkaito (27/02/2022)\r\n     -----------------------------------------------*/\r\n    handleEdit(obj) {\r\n      //emit tới cha nhận sự kiện update\r\n      this.$emit(\"eUpdate\", { data: obj, formMode: 2 });\r\n      //emit tới cha đóng function\r\n      this.$emit(\"handleHideFunc\");\r\n    },\r\n\r\n    /**------------------------------------------\r\n    *Xử lý khi 1 hàng được click\r\n    *Author: quyetkaito (13/04/2022)\r\n    --------------------------------------------*/\r\n    handleClick(object, index) {\r\n      try {\r\n        //emit tới cha đối tượng được click\r\n        this.$emit(\"eClick\", { object, index });\r\n        //xóa background cho tất cả các hàng khác, giữ lại hàng đang được click\r\n        this.$refs.mTable.querySelectorAll(`tbody tr`).forEach((e) => {\r\n          e.classList.remove(\"selected\");\r\n        });\r\n        this.$refs.mTable\r\n          .querySelector(`tbody tr:nth-child(${index + 1})`)\r\n          .classList.add(\"selected\");\r\n      } catch (error) {\r\n        //log ra lỗi\r\n        console.log(error);\r\n      }\r\n    },\r\n\r\n    /**------------------------------------------------\r\n         * Hàm xử lý khi click vào nút [Xóa] trên bảng.\r\n         * @param {Object} obj - đối tượng cần xóa.\r\n         * Author: quyetkaito (27/02/2022)\r\n         ----------------------------------------------*/\r\n    handleDelete(obj) {\r\n      this.$emit(\"onDelete\", obj);\r\n    },\r\n\r\n    /**------------------------------------------------------\r\n     * Hàm thực hiện lấy vị trí click để hiện dropdown content.\r\n     * @param {Object} object - đối tượng ứng với hàng.\r\n     * @param {Event} event\r\n     * @param {Number} index - số thứ tự của hàng được chọn\r\n     * Author: quyetkaito (07/03/2022)\r\n     -----------------------------------------------------------*/\r\n    showOptions(event, object, index) {\r\n      // console.log(index);\r\n      // console.log(this.$refs.dropdownArrow[index]);\r\n      //lấy ra arrow tại hàng đó\r\n      let arrow = this.$refs.dropdownArrow[index];\r\n      //lấy ra vị trí của arrow\r\n      let arrowPosition = arrow.getBoundingClientRect();\r\n\r\n      //emit tới cha show dropdowncontent hiện tại\r\n      this.$emit(\"eShowFunc\", { object, arrowPosition });\r\n    },\r\n\r\n    /**------------------------------------------------\r\n     * Xử lý đóng table Function khi click ra ngoài bảng\r\n     * Author: quyetkaito (13/03/2022)\r\n    -------------------------------------*/\r\n    hideOptions() {\r\n      //emit tới cha ẩn dropdowncontent hiện tại\r\n      this.$emit(\"handleHideFunc\");\r\n    },\r\n\r\n    /**------------------------------------------\r\n    *CSS cho những hàng đang được chọn\r\n    *@param {Object} selectedRow - hàng đang chọn.\r\n    selectedRow, value\r\n    *Author: quyetkaito (15/04/2022)\r\n    --------------------------------------------*/\r\n    addSelectedRow(index) {\r\n      if (this.listData.length > 0) {\r\n        let allRow = this.$el.querySelectorAll(`tbody tr`);\r\n        let thisRow = this.$el.querySelector(\r\n          `tbody tr:nth-child(${index + 1})`\r\n        );\r\n        if (allRow) {\r\n          //xóa background cho tất cả các hàng khác, giữ lại hàng đang được click\r\n          allRow.forEach((e) => {\r\n            e.classList.remove(\"selected\");\r\n          });\r\n          if (thisRow) thisRow.classList.add(\"selected\");\r\n        }\r\n      }\r\n    },\r\n\r\n    /**------------------------------------------\r\n    *Hàm lấy thông tin 1 hàng của table.\r\n    *@param {Number} index số thứ tự hàng, bắt đầu từ 0\r\n    *Author: quyetkaito (01/05/2022)\r\n    --------------------------------------------*/\r\n    getRow(index){\r\n      return this.listData[index];\r\n    }\r\n  },\r\n\r\n  /**------------------------------------------\r\n  *Tính toán data trong grid.\r\n  *Author: quyetkaito (09/04/2022)\r\n  --------------------------------------------*/\r\n  computed: {\r\n    /**-------------------------------------\r\n     * Thực hiện chọn tất cả/ bỏ chọn tất cả\r\n     * Author: quyetkaito (14/03/2022)\r\n     ---------------------------------*/\r\n    selectAll: {\r\n      get: function () {\r\n        //trả về true nếu listData = số hàng được check, false ngược lại\r\n        return this.listData\r\n          ? this.checkedRows.length == this.listData.length &&\r\n              this.listData.length != 0\r\n          : false;\r\n      },\r\n\r\n      //select All\r\n      set: function (value) {\r\n        var selected = [];\r\n        try {\r\n          if (value) {\r\n            console.log(value);\r\n            //tạo danh sách các đối tượng được chọn\r\n            this.listData.forEach(function (data) {\r\n              selected.push(data);\r\n            });\r\n          }\r\n          this.checkedRows = selected;\r\n        } catch (error) {\r\n          this.checkedRows = selected;\r\n          console.log(error);\r\n        }\r\n      },\r\n    },\r\n\r\n    /**------------------------------\r\n     * Tính toán số lượng các cột skeleton.\r\n     * Author: quyetkaito (27/03/2022)\r\n     --------------------------------*/\r\n    columnSkeleton() {\r\n      if (this.multiSelect) {\r\n        return this.columns.length + 2;\r\n      } else {\r\n        return this.columns.length + 1;\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n@import url(\"/src/style/common/table.css\");\r\n.tool-btn {\r\n  white-space: nowrap;\r\n  font-weight: 600 !important;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}