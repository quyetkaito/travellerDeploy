{"ast":null,"code":"import SearchHistoryAPI from \"@/api/SearchHistoryAPI\";\nexport default {\n  name: \"SearchHistory\",\n\n  data() {\n    return {\n      histories: [],\n      userID: this.$session.get(\"UserID\")\n    };\n  },\n\n  created() {\n    this.getData();\n  },\n\n  methods: {\n    /**\r\n    * Lấy lịch sử tìm kiếm của user này\r\n    * @created : quyetkaito 08/11/2022\r\n    */\n    async getData() {\n      try {\n        let me = this;\n\n        if (me.userID) {\n          let res = await SearchHistoryAPI.request(SearchHistoryAPI.urlName + `/history_by_user/${me.userID}`, 'GET');\n\n          if (res && res.data) {\n            this.histories = res.data;\n          }\n        } else {//nếu ko có userID thì lấy trong cache\n        }\n      } catch (error) {\n        console.error(error);\n      }\n    },\n\n    /**\r\n    * hàm xóa lịch sử\r\n    * @created : quyetkaito 08/11/2022\r\n    */\n    async deleteItem(item) {\n      let me = this;\n\n      try {\n        if (me.userID && item && item.id) {\n          let res = await SearchHistoryAPI.request(SearchHistoryAPI.urlName + `/${item.id}`, 'DELETE');\n\n          if (res && res.data) {\n            if (res.data.StatusCode == 200) {\n              me.$store.commit(\"showSuccess\", {\n                message: me.$t('message.success_delete')\n              });\n              this.getData();\n            }\n          }\n        }\n      } catch (error) {\n        console.error(error);\n      }\n    },\n\n    /**\r\n    * Xóa hết lịch sử tìm kiếm\r\n    * @created : quyetkaito 08/11/2022\r\n    */\n    async deleteAll() {\n      try {\n        let me = this;\n\n        if (me.userID) {\n          let res = await SearchHistoryAPI.request(SearchHistoryAPI.urlName + `/delete_all/${me.userID}`, 'DELETE');\n\n          if (res && res.data) {\n            if (res.data.StatusCode == 200) {\n              me.$store.commit(\"showSuccess\", {\n                message: me.$t('message.success_delete')\n              });\n              this.getData();\n            }\n          }\n        }\n      } catch (error) {\n        console.error(error);\n      }\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAmBA,OAAOA,gBAAP,MAA6B,wBAA7B;AACA,eAAe;EACXC,IAAI,EAAE,eADK;;EAEXC,IAAI,GAAG;IACH,OAAO;MACHC,SAAS,EAAE,EADR;MAEHC,MAAM,EAAE,KAAKC,QAAL,CAAcC,GAAd,CAAkB,QAAlB;IAFL,CAAP;EAIH,CAPU;;EAQXC,OAAO,GAAE;IACL,KAAKC,OAAL;EACH,CAVU;;EAWXC,OAAO,EAAC;IACJ;;;;IAIA,MAAMD,OAAN,GAAe;MACX,IAAI;QACA,IAAIE,EAAC,GAAI,IAAT;;QACA,IAAGA,EAAE,CAACN,MAAN,EAAa;UACT,IAAIO,GAAE,GAAI,MAAMX,gBAAgB,CAACY,OAAjB,CAAyBZ,gBAAgB,CAACa,OAAjB,GAA0B,oBAAmBH,EAAE,CAACN,MAAO,EAAhF,EAAmF,KAAnF,CAAhB;;UACA,IAAGO,GAAE,IAAKA,GAAG,CAACT,IAAd,EAAmB;YACf,KAAKC,SAAL,GAAiBQ,GAAG,CAACT,IAArB;UACJ;QACH,CALD,MAKK,CAAE;QAEP;MACJ,CAVA,CAUE,OAAOY,KAAP,EAAc;QACZC,OAAO,CAACD,KAAR,CAAcA,KAAd;MACJ;IACH,CAnBG;;IAqBJ;;;;IAIA,MAAME,UAAN,CAAiBC,IAAjB,EAAsB;MAClB,IAAIP,EAAC,GAAI,IAAT;;MACA,IAAI;QACA,IAAGA,EAAE,CAACN,MAAH,IAAaa,IAAb,IAAqBA,IAAI,CAACC,EAA7B,EAAgC;UAC5B,IAAIP,GAAE,GAAI,MAAMX,gBAAgB,CAACY,OAAjB,CAAyBZ,gBAAgB,CAACa,OAAjB,GAA0B,IAAGI,IAAI,CAACC,EAAG,EAA9D,EAAiE,QAAjE,CAAhB;;UACA,IAAGP,GAAE,IAAKA,GAAG,CAACT,IAAd,EAAmB;YACf,IAAGS,GAAG,CAACT,IAAJ,CAASiB,UAAT,IAAuB,GAA1B,EAA8B;cAC1BT,EAAE,CAACU,MAAH,CAAUC,MAAV,CAAiB,aAAjB,EAAgC;gBAACC,OAAO,EAAEZ,EAAE,CAACa,EAAH,CAAM,wBAAN;cAAV,CAAhC;cACA,KAAKf,OAAL;YACJ;UACJ;QACJ;MACJ,CAVA,CAUE,OAAOM,KAAP,EAAc;QACZC,OAAO,CAACD,KAAR,CAAcA,KAAd;MACJ;IACH,CAxCG;;IA0CJ;;;;IAIA,MAAMU,SAAN,GAAiB;MACb,IAAI;QACA,IAAId,EAAC,GAAI,IAAT;;QACA,IAAGA,EAAE,CAACN,MAAN,EAAa;UACT,IAAIO,GAAE,GAAI,MAAMX,gBAAgB,CAACY,OAAjB,CAAyBZ,gBAAgB,CAACa,OAAjB,GAA0B,eAAcH,EAAE,CAACN,MAAO,EAA3E,EAA8E,QAA9E,CAAhB;;UACA,IAAGO,GAAE,IAAKA,GAAG,CAACT,IAAd,EAAmB;YACf,IAAGS,GAAG,CAACT,IAAJ,CAASiB,UAAT,IAAuB,GAA1B,EAA8B;cAC1BT,EAAE,CAACU,MAAH,CAAUC,MAAV,CAAiB,aAAjB,EAAgC;gBAACC,OAAO,EAAEZ,EAAE,CAACa,EAAH,CAAM,wBAAN;cAAV,CAAhC;cACA,KAAKf,OAAL;YACJ;UACJ;QACJ;MACJ,CAXA,CAWE,OAAOM,KAAP,EAAc;QACZC,OAAO,CAACD,KAAR,CAAcA,KAAd;MACJ;IACJ;;EA7DI;AAXG,CAAf","names":["SearchHistoryAPI","name","data","histories","userID","$session","get","created","getData","methods","me","res","request","urlName","error","console","deleteItem","item","id","StatusCode","$store","commit","message","$t","deleteAll"],"sourceRoot":"","sources":["D:\\Traveller\\Traveller-Frontend\\traveller-ui\\src\\views\\landing-page\\search-history\\SearchHistoryPage.vue"],"sourcesContent":["<template>\r\n<div class=\"search-history-page\">\r\n    <div class=\"page-header flex justify-between align-y-center\">\r\n        <div class=\"title-page\">Lịch sử tìm kiếm</div>\r\n        <div class=\"delete-all\" @click=\"deleteAll\" v-if=\"histories.length > 0\">Xóa các tìm kiếm</div>\r\n    </div>\r\n    <div class=\"search-history-item\" v-for=\"(item,index) in histories\" :key=\"index\">\r\n        <div class=\"flex justify-between\">\r\n            <div class=\"search-date mr-2\">{{$commonFunc.formatDate(item.search_date)}}</div>\r\n            <div class=\"cursor-pointer\" title=\"Xóa\" @click=\"deleteItem(item)\"><i class=\"fas fa-trash-alt text-red-500\"></i></div>\r\n            \r\n        </div>        \r\n        <blockquote><div>Bạn đã tìm kiếm: \"{{item.search_content}}\"</div></blockquote>\r\n        <div class=\"time\">{{$commonFunc.getTimeOnly(item.search_date)}}</div>\r\n    </div>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport SearchHistoryAPI from \"@/api/SearchHistoryAPI\"\r\nexport default {\r\n    name: \"SearchHistory\",\r\n    data() {\r\n        return {\r\n            histories: [],\r\n            userID: this.$session.get(\"UserID\"),\r\n        }\r\n    },\r\n    created(){\r\n        this.getData();\r\n    },\r\n    methods:{\r\n        /**\r\n        * Lấy lịch sử tìm kiếm của user này\r\n        * @created : quyetkaito 08/11/2022\r\n        */\r\n        async getData(){\r\n            try {\r\n                let me = this;\r\n                if(me.userID){\r\n                    let res = await SearchHistoryAPI.request(SearchHistoryAPI.urlName+`/history_by_user/${me.userID}`, 'GET');\r\n                    if(res && res.data){                        \r\n                        this.histories = res.data;\r\n                    }\r\n                }else{ //nếu ko có userID thì lấy trong cache\r\n\r\n                }\r\n            } catch (error) {\r\n                console.error(error)\r\n            }\r\n        },\r\n\r\n        /**\r\n        * hàm xóa lịch sử\r\n        * @created : quyetkaito 08/11/2022\r\n        */\r\n        async deleteItem(item){\r\n            let me = this;\r\n            try {\r\n                if(me.userID && item && item.id){\r\n                    let res = await SearchHistoryAPI.request(SearchHistoryAPI.urlName+`/${item.id}`, 'DELETE');\r\n                    if(res && res.data){\r\n                        if(res.data.StatusCode == 200){\r\n                            me.$store.commit(\"showSuccess\", {message: me.$t('message.success_delete')});\r\n                            this.getData();\r\n                        }\r\n                    }\r\n                }             \r\n            } catch (error) {\r\n                console.error(error)\r\n            }\r\n        },\r\n\r\n        /**\r\n        * Xóa hết lịch sử tìm kiếm\r\n        * @created : quyetkaito 08/11/2022\r\n        */\r\n        async deleteAll(){\r\n            try {\r\n                let me = this;\r\n                if(me.userID){\r\n                    let res = await SearchHistoryAPI.request(SearchHistoryAPI.urlName+`/delete_all/${me.userID}`, 'DELETE');\r\n                    if(res && res.data){\r\n                        if(res.data.StatusCode == 200){\r\n                            me.$store.commit(\"showSuccess\", {message: me.$t('message.success_delete')});\r\n                            this.getData();\r\n                        }\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                console.error(error)\r\n            }\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.search-history-page{\r\n    padding: 10px;\r\n\r\n    .page-header {\r\n        .title-page{\r\n            margin-top: 15px;\r\n            margin-bottom: 10px;\r\n            font-size: 20px;\r\n            font-weight: 700;\r\n        }\r\n        .delete-all{\r\n            color: var(--info-color);\r\n            cursor: pointer;\r\n        }\r\n\r\n    }\r\n}\r\n.search-history-item{\r\n    background: white;\r\n    border-radius: 5px;\r\n    padding: 15px;\r\n    margin-bottom: 10px;\r\n    @apply shadow-md;\r\n    .search-date{\r\n        font-weight: 700;\r\n        font-size: 16px;\r\n    }\r\n    .time{\r\n        font-size: 13px;        \r\n    }\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}