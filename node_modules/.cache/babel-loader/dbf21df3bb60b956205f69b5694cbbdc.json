{"ast":null,"code":"import UserAPI from '@/api/UserAPI'; // import DatePicker\n\nimport NextDatePicker from \"vue-datepicker-next\";\nimport \"vue-datepicker-next/index.css\";\nimport \"vue-datepicker-next/locale/vi\";\nimport { getStorage, ref, uploadBytes, getMetadata, getDownloadURL } from \"firebase/storage\";\nconst storage = getStorage();\nimport { v4 as uuidv4 } from 'uuid';\nexport default {\n  components: {\n    \"v-date-picker\": NextDatePicker\n  },\n\n  data() {\n    return {\n      currentItem: {},\n      //thông tin user\n      isViewing: false,\n      originalItem: {},\n      //lưu lại để so sánh sự thay đổi\n      typeButton: 'info',\n      imgSrc: \"\"\n    };\n  },\n\n  created() {\n    this.getUserInfo();\n  },\n\n  mounted() {\n    this.imgSrc = this.currentItem.user_avatar_img ? this.currentItem.user_avatar_img : require(`@/assets/img/default-avatar.jpg`);\n  },\n\n  /**\r\n  * Hàm xác nhận chuyển màn hình. Nếu chưa lưu thì hỏi có muốn lưu hay không.\r\n  * @created : quyetkaito 12/10/2022\r\n  */\n  beforeRouteLeave(to, from, next) {\n    let me = this;\n\n    if (!me.$commonFunc.isDeepEqual(me.currentItem, me.originalItem)) {\n      if (confirm(\"bạn chưa lưu, có muốn chuyển không?\")) {\n        next();\n      } else {\n        next(false);\n      }\n    } else {\n      next();\n    }\n  },\n\n  methods: {\n    /**\r\n    * Xử lý khi ảnh thay đổi\r\n    * @created : quyetkaito 13/10/2022\r\n    */\n    changeAvatar(e) {\n      let me = this;\n      const metadata = {\n        contentType: 'image/jpeg'\n      };\n\n      if (me.$commonFunc.validateInputImage(e.target)) {\n        const storageRef = ref(storage, `image/${uuidv4()}.jpeg`); // Upload the file and metadata\n\n        debugger;\n        const uploadTask = uploadBytes(storageRef, e.target.files[0], metadata).then(() => {\n          getDownloadURL(storageRef).then(x => {\n            document.getElementById('userAvatar').style.display = 'block';\n            document.getElementById('userAvatar').src = x;\n            me.$store.state.userAvatar = x;\n            me.currentItem.user_avatar_img = x;\n          });\n        });\n      }\n    },\n\n    chooseAvatar() {\n      let me = this;\n\n      if (me.$refs.chooseAvt) {\n        me.$refs.chooseAvt.click();\n      }\n    },\n\n    disabledDateBeforeToday(date) {\n      return date > new Date();\n    },\n\n    /**\r\n    * Gọi APi lưu thông tin người dùng\r\n    * @created : quyetkaito 12/10/2022\r\n    */\n    async saveInfo() {\n      let me = this;\n\n      if (me.currentItem && this.currentItem.user_id) {\n        //build object\n        me.currentItem.date_of_birth = me.$commonFunc.setTimeZone(me.currentItem.date_of_birth);\n        let res = await UserAPI.request(UserAPI.urlName, 'PUT', this.currentItem);\n\n        if (res && res.data) {\n          me.$store.commit('showInfo', {\n            message: res.data.UserMsg,\n            timeout: 1200\n          });\n          me.typeButton = 'gray';\n          me.currentItem.date_of_birth = new Date(me.currentItem.date_of_birth);\n          me.$session.set('UserAvatar', me.currentItem.user_avatar_img);\n        } else {\n          me.$store.commit('showError', {\n            message: res.data.UserMsg,\n            timeout: 1200\n          });\n        }\n      }\n    },\n\n    /**\r\n    * Hàm lấy thông tin người dùng\r\n    * @created : quyetkaito 12/10/2022\r\n    */\n    async getUserInfo() {\n      try {\n        let me = this; //lấy trong sesstion nếu có\n\n        let userInfo = me.$session.get(\"UserInfo\");\n\n        if (userInfo) {\n          me.currentItem = userInfo;\n          debugger;\n\n          if (me.currentItem.hasOwnProperty('date_of_birth')) {\n            me.currentItem.date_of_birth = new Date(me.currentItem.date_of_birth);\n          }\n\n          if (me.currentItem.user_avatar_img) {\n            if (this.$refs.userAvatar) {\n              this.$refs.userAvatar.src = me.currentItem.user_avatar_img;\n            }\n\n            me.$store.state.userAvatar = me.currentItem.user_avatar_img;\n          }\n\n          me.originalItem = JSON.parse(JSON.stringify(me.currentItem));\n        } else {\n          //lấy tươi\n          let userId = me.$session.get('UserID');\n\n          if (userId) {\n            let res = await UserAPI.request(UserAPI.urlName + `/${userId}`, 'GET');\n\n            if (res && res.data) {\n              me.$session.set(\"UserInfo\", res.data);\n              me.currentItem = JSON.parse(JSON.stringify(res.data));\n\n              if (me.currentItem.hasOwnProperty('date_of_birth')) {\n                me.currentItem.date_of_birth = new Date(me.currentItem.date_of_birth);\n              }\n\n              if (me.currentItem.user_avatar_img) {\n                document.getElementById('userAvatar').src = me.currentItem.user_avatar_img;\n                me.$store.state.userAvatar = me.currentItem.user_avatar_img;\n              }\n\n              me.originalItem = JSON.parse(JSON.stringify(me.currentItem));\n            }\n          }\n        }\n      } catch (error) {\n        console.error(error);\n      }\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["UserAPI","NextDatePicker","getStorage","ref","uploadBytes","getMetadata","getDownloadURL","storage","v4","uuidv4","components","data","currentItem","isViewing","originalItem","typeButton","imgSrc","created","getUserInfo","mounted","user_avatar_img","require","beforeRouteLeave","to","from","next","me","$commonFunc","isDeepEqual","confirm","methods","changeAvatar","e","metadata","contentType","validateInputImage","target","storageRef","uploadTask","files","then","x","document","getElementById","style","display","src","$store","state","userAvatar","chooseAvatar","$refs","chooseAvt","click","disabledDateBeforeToday","date","Date","saveInfo","user_id","date_of_birth","setTimeZone","res","request","urlName","commit","message","UserMsg","timeout","$session","set","userInfo","get","hasOwnProperty","JSON","parse","stringify","userId","error","console"],"sourceRoot":"","sources":["D:\\Traveller\\Traveller-Frontend\\traveller-ui\\src\\views\\user-info\\UserInfo.vue"],"sourcesContent":["<template>\r\n  <div class=\"userinfo-container flex\">\r\n    <div class=\"w-1/3 overview\">\r\n      <div class=\"flex align-x-center\">\r\n        <div class=\"user-avatar mt-10 rounded-full\">\r\n           <input type=\"file\" style=\"display: none;\" id=\"choose-avt\" ref=\"chooseAvt\" @change=\"changeAvatar\">\r\n           <img id=\"userAvatar\" ref=\"userAvatar\" :src=\"imgSrc\" alt=\"\" class=\"rounded-full\" @click=\"chooseAvatar\">\r\n        </div>\r\n      </div>\r\n      <div class=\"name flex align-x-center mt-4\">{{currentItem.full_name}}</div>\r\n    </div>  \r\n    <div class=\"w-2/3 info-detail\">\r\n      <div class=\" form-title flex align-y-center\">\r\n        <div class=\"mr-10 title\">Thông tin cá nhân</div>\r\n        <div class=\"btn-save\">\r\n          <m-button\r\n            :text=\"$t('Save')\"\r\n            :type=\"typeButton\"\r\n            @click=\"saveInfo\"\r\n          ></m-button>\r\n        </div>\r\n      </div>\r\n      \r\n      <div class=\"m-form-field\">\r\n        <div class=\"form-item\" style=\"width: 50%; margin-right: 10px;\">\r\n          <m-input\r\n            :labelText=\"$t('Email')\"\r\n            v-model=\"currentItem.email\"            \r\n            :readonly=\"true\"\r\n            :isAutoFocus=\"true\"\r\n            :maxlength=\"20\"\r\n            placeholder=\"\"\r\n            :style=\"{ width: '100%' }\"\r\n            ref=\"email\"            \r\n          />\r\n        </div>    \r\n        <div class=\"form-item\" style=\"width: 50%\">\r\n          <m-input\r\n            :labelText=\"$t('Phone')\"\r\n            v-model=\"currentItem.phone\"            \r\n            :readonly=\"isViewing\"\r\n            :isAutoFocus=\"true\"\r\n            :maxlength=\"20\"\r\n            placeholder=\"\"\r\n            :style=\"{ width: '100%' }\"\r\n            ref=\"email\"            \r\n          />\r\n        </div>              \r\n      </div>\r\n      <div class=\"m-form-field\">\r\n        <div class=\"form-item\" style=\"width: 100%\">\r\n          <m-input\r\n            :labelText=\"$t('FullName')\"\r\n            v-model=\"currentItem.full_name\"            \r\n            :readonly=\"isViewing\"\r\n            :isAutoFocus=\"true\"\r\n            :maxlength=\"20\"\r\n            placeholder=\"\"\r\n            :style=\"{ width: '100%' }\"\r\n            ref=\"email\"            \r\n          />\r\n        </div>                  \r\n      </div>\r\n      <div class=\"m-form-field\">\r\n          <div class=\"form-item\" style=\"padding-right: 6px; width: 40%\">\r\n            <m-label text=\"Ngày sinh\" />\r\n            <v-date-picker\r\n              v-model:value=\"currentItem.date_of_birth\"\r\n              :format=\"$store.state.dateFormat\"\r\n              :placeholder=\"$store.state.dateFormat\"\r\n              :lang=\"$store.state.langString\"\r\n              :disabled-date=\"disabledDateBeforeToday\"\r\n              :clearable=\"false\"\r\n              title-format=\"DD/MM/YYYY\"\r\n            />\r\n          </div>\r\n          <div class=\"form-item\" style=\"width: 60%; padding-left: 6px\">\r\n            <m-label text=\"Giới tính\" />\r\n            <div class=\"mt-3 m-field-gender\">\r\n              <m-radio v-model=\"currentItem.gender\" :value=\"1\" label=\"Nam\"/>\r\n              <m-radio v-model=\"currentItem.gender\" :value=\"0\" label=\"Nữ\" />\r\n              <m-radio v-model=\"currentItem.gender\" :value=\"2\" label=\"Khác\"/>                      \r\n            </div>\r\n          </div>\r\n      </div>\r\n      <div class=\"m-form-field\">\r\n        <div class=\"form-item\" style=\"width: 100%\">\r\n          <m-input\r\n            labelText=\"Địa chỉ\"\r\n            :maxlength=\"255\"\r\n            :readonly=\"isViewing\"\r\n            v-model=\"currentItem.address\"\r\n            placeholder=\"\"\r\n            :style=\"{ width: '100%' }\"\r\n            ref=\"address\"\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>    \r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport UserAPI from '@/api/UserAPI';\r\n// import DatePicker\r\nimport NextDatePicker from \"vue-datepicker-next\";\r\nimport \"vue-datepicker-next/index.css\";\r\nimport \"vue-datepicker-next/locale/vi\";\r\nimport { getStorage, ref, uploadBytes, getMetadata, getDownloadURL } from \"firebase/storage\";\r\nconst storage = getStorage();\r\nimport { v4 as uuidv4 } from 'uuid';\r\n\r\nexport default {\r\n  components: {\r\n    \"v-date-picker\": NextDatePicker,\r\n  },\r\n  data() {\r\n    return {\r\n      currentItem: {}, //thông tin user\r\n      isViewing: false,\r\n      originalItem: {}, //lưu lại để so sánh sự thay đổi\r\n      typeButton: 'info',\r\n      imgSrc: \"\",\r\n    }\r\n  }, \r\n  created(){\r\n    this.getUserInfo();\r\n  },\r\n  mounted(){    \r\n    this.imgSrc = this.currentItem.user_avatar_img ?this.currentItem.user_avatar_img :require(`@/assets/img/default-avatar.jpg`);\r\n  },\r\n  /**\r\n  * Hàm xác nhận chuyển màn hình. Nếu chưa lưu thì hỏi có muốn lưu hay không.\r\n  * @created : quyetkaito 12/10/2022\r\n  */\r\n  beforeRouteLeave(to, from, next){      \r\n    let me = this;\r\n    if(!me.$commonFunc.isDeepEqual(me.currentItem, me.originalItem)){\r\n      if(confirm(\"bạn chưa lưu, có muốn chuyển không?\")){\r\n        next();\r\n      }else{\r\n        next(false);\r\n      }\r\n    }else{\r\n      next();\r\n    }\r\n  },\r\n  methods:{\r\n    /**\r\n    * Xử lý khi ảnh thay đổi\r\n    * @created : quyetkaito 13/10/2022\r\n    */\r\n    changeAvatar(e){\r\n        let me = this;\r\n        const metadata = {\r\n          contentType: 'image/jpeg',\r\n        };\r\n        if(me.$commonFunc.validateInputImage(e.target)){\r\n          const storageRef = ref(storage, `image/${uuidv4()}.jpeg`);\r\n          // Upload the file and metadata\r\n          debugger\r\n          const uploadTask = uploadBytes(storageRef, e.target.files[0], metadata).then(()=>{\r\n            getDownloadURL(storageRef).then((x)=>{                    \r\n               document.getElementById('userAvatar').style.display = 'block';           \r\n               document.getElementById('userAvatar').src = x;\r\n               me.$store.state.userAvatar = x;\r\n               me.currentItem.user_avatar_img = x;\r\n            })            \r\n          });        \r\n        }      \r\n    },\r\n\r\n    chooseAvatar(){\r\n      let me = this;\r\n      if(me.$refs.chooseAvt){\r\n        me.$refs.chooseAvt.click();\r\n      }\r\n    },\r\n    disabledDateBeforeToday(date){\r\n        return date > new Date();\r\n    },\r\n    /**\r\n    * Gọi APi lưu thông tin người dùng\r\n    * @created : quyetkaito 12/10/2022\r\n    */\r\n    async saveInfo(){\r\n      let me = this;\r\n      if(me.currentItem && this.currentItem.user_id){\r\n          //build object\r\n          me.currentItem.date_of_birth = me.$commonFunc.setTimeZone(me.currentItem.date_of_birth);\r\n          let res = await UserAPI.request(UserAPI.urlName, 'PUT', this.currentItem);\r\n          if(res && res.data){                            \r\n              me.$store.commit('showInfo', {message: res.data.UserMsg, timeout: 1200});\r\n              me.typeButton = 'gray';\r\n              me.currentItem.date_of_birth = new Date(me.currentItem.date_of_birth);\r\n              me.$session.set('UserAvatar', me.currentItem.user_avatar_img);\r\n          }else{\r\n              me.$store.commit('showError', {message: res.data.UserMsg, timeout: 1200});\r\n          }\r\n      }\r\n    },\r\n\r\n    /**\r\n    * Hàm lấy thông tin người dùng\r\n    * @created : quyetkaito 12/10/2022\r\n    */\r\n    async getUserInfo(){\r\n        try {\r\n          let me = this;\r\n          //lấy trong sesstion nếu có\r\n          let userInfo = me.$session.get(\"UserInfo\");\r\n          if(userInfo){\r\n              me.currentItem = userInfo;\r\n              debugger\r\n              if(me.currentItem.hasOwnProperty('date_of_birth')){\r\n                  me.currentItem.date_of_birth = new Date(me.currentItem.date_of_birth);\r\n              }\r\n              if(me.currentItem.user_avatar_img){\r\n                if(this.$refs.userAvatar){\r\n                  this.$refs.userAvatar.src = me.currentItem.user_avatar_img;\r\n                }\r\n                me.$store.state.userAvatar = me.currentItem.user_avatar_img;\r\n              }\r\n              me.originalItem = JSON.parse(JSON.stringify(me.currentItem));\r\n          }else{ //lấy tươi\r\n            let userId = me.$session.get('UserID');          \r\n            if(userId){\r\n              let res = await UserAPI.request(UserAPI.urlName+`/${userId}`, 'GET');\r\n              if(res && res.data){       \r\n                 me.$session.set(\"UserInfo\", res.data);                     \r\n                 me.currentItem = JSON.parse(JSON.stringify(res.data));\r\n                 if(me.currentItem.hasOwnProperty('date_of_birth')){\r\n                    me.currentItem.date_of_birth = new Date(me.currentItem.date_of_birth);\r\n                 }\r\n                 if(me.currentItem.user_avatar_img){\r\n                    document.getElementById('userAvatar').src = me.currentItem.user_avatar_img;\r\n                    me.$store.state.userAvatar = me.currentItem.user_avatar_img;\r\n                 }\r\n                 me.originalItem = JSON.parse(JSON.stringify(me.currentItem));\r\n              }\r\n            }\r\n          }\r\n        } catch (error) {\r\n          console.error(error)\r\n        }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.m-form-field {\r\n    display: flex;\r\n    width: 100%;\r\n    padding-bottom: 12px;\r\n}\r\n\r\n.form-item {\r\n    box-sizing: border-box;\r\n}\r\n.userinfo-container {\r\n  height: 100%;\r\n}\r\n\r\n.userinfo-container .overview{\r\n  border-right: 2px solid #918e8e;  \r\n}\r\n\r\n.userinfo-container .overview .name{\r\n  font-weight: bold;\r\n}\r\n\r\n.userinfo-container .info-detail{\r\n  padding: 10px;\r\n}\r\n\r\n.user-avatar{\r\n  width: 200px;\r\n  height: 200px;\r\n  border: 5px solid #16d6e4;  \r\n}\r\n.info-detail .form-title{\r\n  margin-bottom: 10px;\r\n}\r\n.info-detail .btn-save{\r\n  text-align: left;\r\n}\r\n.info-detail .title{\r\n  font-weight: bold;\r\n  font-size: 30px;\r\n}\r\n.user-avatar img{\r\n  object-fit: cover;\r\n  width: 100%;\r\n  height: 100%;\r\n\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}