{"ast":null,"code":"//import Library\nimport _ from \"lodash\"; // const FileDownload = require(\"js-file-download\");\n//multi vue 3\n\nimport vMultiselect from \"@vueform/multiselect\";\nimport \"@vueform/multiselect/themes/default.css\";\nimport UserAPI from \"@/api/UserAPI\";\nimport UserDetail from \"@/views/user/UserDetail.vue\";\nexport default {\n  name: \"EmployeeList\",\n  components: {\n    // \"ms-employee-dialog\": EmployeeDetail,\n    // \"ms-pagination\": MSPagination,\n    \"v-multiselect\": vMultiselect,\n    \"user-detail\": UserDetail\n  },\n\n  //   directives: {\n  //     clickOutside: vClickOutside.directive,\n  //   },\n\n  /**---------------------------\r\n   * Giai đoạn 2: có thể truy cập vào data, event, chưa truy cập dc DOM\r\n   -----------------------------*/\n  created() {\n    this.loadData();\n  },\n\n  /**--------------\r\n   * Data\r\n  -----------------*/\n  data() {\n    return {\n      storeUser: [],\n      //danh sách mã giảm giá\n      isShowDialog: false,\n      //dialog có hiện không?\n      isShowPopup: false,\n      //popup có hiện không?\n      isShowFunc: false,\n      //function của table có hiện không?\n      isShowMultiAction: false,\n      //dropdown của thực hiện hàng loạt có hiện không?\n      isShowSkeleton: false,\n      //có đang hiện skeleton ko?\n      itemSelected: {},\n      //đối tượng nhân viên đang được chọn để thao tác.\n      formMode: 0,\n      //trạng thái form đang là gì?\n      //set text,type cho popup\n      popupText: null,\n      popupType: null,\n      isMultiDelete: false,\n      //có đang xóa nhiều không?\n      //thông tin của toast\n      toastText: \"toast-text\",\n      toastType: 0,\n      //các option cho paging\n      pagingOptions: [{\n        label: \"10 bản ghi trên 1 trang\",\n        value: 10\n      }, {\n        label: \"20 bản ghi trên 1 trang\",\n        value: 20\n      }, {\n        label: \"30 bản ghi trên 1 trang\",\n        value: 30\n      }, {\n        label: \"50 bản ghi trên 1 trang\",\n        value: 50\n      }, {\n        label: \"100 bản ghi trên 1 trang\",\n        value: 100\n      }],\n      disableComboboxPaging: false,\n      pageNumber: 1,\n      //trang số bao nhiêu\n      pageSize: 10,\n      //số bản ghi trên 1 trang\n      totalPage: null,\n      //tổng số trang\n      totalEmp: null,\n      //tổng số bản ghi dữ liệu\n      dataFilter: \"\",\n      //giá trị để tìm kiếm\n      multiDeleteText: \"Xóa\",\n      //thông tin khởi tạo table\n      //danh sách các tiêu đề và fieldName của bảng\n      columns: [{\n        title: \"Họ và tên\",\n        key: \"full_name\",\n        width: 200\n      }, {\n        title: \"email\",\n        key: \"email\",\n        width: 200\n      }, {\n        title: \"Ngày sinh\",\n        key: \"date_of_birth\",\n        width: 200,\n        dataType: \"date\",\n        titleAlign: \"center\"\n      }, {\n        title: \"Tên đăng nhập\",\n        key: \"username\",\n        width: 200\n      }, {\n        title: \"Số điện thoại\",\n        key: \"phone\",\n        width: 150,\n        titleAlign: \"left\"\n      }],\n      //các function của table\n      tableFunction: [{\n        title: \"Nhân bản\",\n        value: this.$enum.TableFunction.Clone\n      }, {\n        title: \"Xóa\",\n        value: this.$enum.TableFunction.Delete\n      }, {\n        title: \"Ngừng sử dụng\",\n        value: this.$enum.TableFunction.Stop\n      }],\n      listEmployeeChecked: []\n    };\n  },\n\n  /**-----------------\r\n   * Các phương thức\r\n   -------------------*/\n  methods: {\n    /**\r\n    * Hàm nhận sự kiện gửi từ grid ra\r\n    * @created : quyetkaito 07/10/2022\r\n    */\n    handleGridAction(options) {\n      if (options) {\n        if (options.object) {\n          if (options.action == 'View') {\n            this.view(options.object);\n          } else if (options.action == 'Delete') {\n            this.deleteObject(options.object);\n          } else if (options.action == 'Edit') {\n            this.edit(options.object);\n          }\n        }\n      }\n    },\n\n    /**\r\n    * Hàm xử lý sự kiện cho các button trên màn hình\r\n    * @created : quyetkaito 04/10/2022\r\n    * @param {string} action : tên hành đông\r\n    */\n    buttonClick(action) {\n      if (!action) return;\n      let me = this;\n\n      switch (action) {\n        case 'Add':\n          me.add();\n          break;\n\n        case 'Edit':\n          me.edit();\n          break;\n\n        case 'View':\n          me.view();\n          break;\n\n        case 'Refresh':\n          me.loadData();\n          break;\n\n        default:\n          break;\n      }\n    },\n\n    view(object) {\n      if (object) {\n        let me = this;\n\n        if (me.$refs.userDialog && typeof me.$refs.userDialog.show == \"function\") {\n          me.$refs.userDialog.show(); //bắn dữ liệu lên form\n\n          if (typeof me.$refs.userDialog.bindData == \"function\") {\n            me.$refs.userDialog.bindData(object, 'View');\n          }\n        }\n      }\n    },\n\n    /**\r\n    * Hàm xử lý sửa đối tượng\r\n    * @created : quyetkaito 06/10/2022\r\n    */\n    edit(object) {\n      if (object) {\n        let me = this;\n\n        if (me.$refs.userDialog && typeof me.$refs.userDialog.show == \"function\") {\n          me.$refs.userDialog.show(); //bắn dữ liệu lên form\n\n          if (typeof me.$refs.userDialog.bindData == \"function\") {\n            me.$refs.userDialog.bindData(object, 'Edit');\n          }\n        }\n      }\n    },\n\n    /**\r\n    * hàm xử lý xóa đối tượng\r\n    * @created : quyetkaito 07/10/2022\r\n    */\n    async deleteObject(object) {\n      if (object) {\n        //cảnh báo có thực sự muốn xóa không\n        let me = this;\n\n        if (confirm(\"bạn có thực sự muốn xóa ko\")) {\n          if (object.user_id) {\n            me.$commonFunc.load();\n\n            try {\n              await UserAPI.request(`${UserAPI.urlName}/${object.user_id}`, 'DELETE').then(res => {\n                console.log(`res`, res);\n                me.$commonFunc.unload();\n                me.buttonClick('Refresh');\n              });\n            } catch (error) {\n              me.handleException(error);\n            }\n          }\n        }\n      }\n    },\n\n    /**\r\n    * Hàm xử lý thêm mới đối tượng\r\n    * @created : quyetkaito 04/10/2022\r\n    */\n    add() {\n      //mở form\n      let me = this;\n\n      if (me.$refs.userDialog && typeof me.$refs.userDialog.show == \"function\") {\n        me.$refs.userDialog.show('Add');\n      } //khởi tạo dữ liệu ban đầu\n\n    },\n\n    showToast() {//show toast\n      //   this.$store.commit(\"showError\", {\n      //     message: \"Lỗi rồi em ei\",\n      //   });\n      // this.$store.commit(\"setLang\", \"en\");\n      //thay đổi ngôn ngữ\n      // this.$i18n.changeLocale('en');\n    },\n\n    /**--------------------------\r\n     * Hàm thực hiện đóng dialog nhân viên.\r\n     * Author: quyetnv(22/03/2022)\r\n     -----------------------------*/\n    closeDialog() {\n      this.itemSelected = {};\n      this.formMode = 0;\n      this.isShowDialog = false;\n    },\n\n    /**----------------------------------\r\n     * Hàm gọi API xuất dữ liệu.\r\n     * Author: quyetkaito (15/03/2022)\r\n    -------------------------------*/\n    exportData() {\n      let me = this;\n      me.$refs.mLoading.show();\n      let object = {};\n      object.tableInfos = me.listHeader;\n      object.dataFilter = me.dataFilter; //gửi lên server danh sách các header\n      //   axios\n      //     .post(`${LOCAL_EMPLOYEE_API_URL}/export`, object, {\n      //       responseType: \"blob\",\n      //     })\n      //     .then((response) => {\n      //       FileDownload(response.data, \"Danh_sach_nhan_vien.xlsx\");\n      //       me.$refs.mLoading.hide();\n      //     })\n      //     .catch(() => {\n      //       me.$refs.mLoading.hide();\n      //     });\n    },\n\n    /**--------------------------------------\r\n     * Xử lý khi nút [Xóa hàng loạt] được chọn\r\n     * Author: quyetkaito (14/03/2022)\r\n    ----------------------------------*/\n    // handleMultiDelete() {\n    //   this.isMultiDelete = true;\n    //   //show cảnh báo xóa nhiều\n    //   this.showPopup(this.$enum.PopupType.DataDelete);\n    // },\n\n    /**----------------------------\r\n     * Thực hiện gọi API xóa nhiều.\r\n     * Author: quyetkaito (14/03/2022)\r\n     ------------------------------*/\n    // multiDeleteEmployee() {\n    //   let me = this;\n    //   //hiện loading\n    //   me.$refs.mLoading.show();\n    //   //gọi API xóa nhiều\n    //   axios\n    //     .delete(`${LOCAL_EMPLOYEE_API_URL}`, { data: me.listEmployeeChecked })\n    //     .then(() => {\n    //       //đóng popup\n    //       me.showMessagebox(false);\n    //       //thông báo thành công\n    //     //   me.toastText = Resource.SuccessDelete;\n    //       me.$refs.msToast.show();\n    //       //reset lại danh sách employee được chọn\n    //       me.listEmployeeChecked = [];\n    //       me.isMultiDelete = false;\n    //       //ẩn loading\n    //       me.$refs.mLoading.hide();\n    //       //load lại dữ liệu\n    //       me.loadData();\n    //       //bỏ dấu check all\n    //       this.$refs.mygrid.unCheckAll();\n    //     })\n    //     .catch((error) => {\n    //       me.handleException(error);\n    //       //reset lại danh sách employee được chọn\n    //       me.listEmployeeChecked = [];\n    //       me.isMultiDelete = false;\n    //       me.$refs.mLoading.hide();\n    //     });\n    // },\n\n    /**-----------------------------------------------------\r\n     * Lấy danh sách id của các employee được chọn từ bảng.\r\n     * @param {Array} listChecked - mảng các đối tượng nhân viên được chọn.\r\n     * Author: quyetkaito (14/03/2022)\r\n     -------------------------------------------------------*/\n    getitemSelected(listChecked) {\n      try {\n        //lấy ra id của đối tượng\n        listChecked.forEach(employee => {\n          //push vào mảng các id của nhân viên\n          this.listEmployeeChecked.push(employee.employee_id);\n        });\n      } catch (error) {\n        //log ra lỗi\n        console.error(error);\n      }\n    },\n\n    /**-----------------------------------\r\n     * Thực hiện ẩn/ hiện nút \"Xóa nhiều\".\r\n     * Author: quyetkaito (14/03/2022)\r\n     -------------------------------------*/\n    toggleMultiAction() {\n      this.isShowMultiAction = !this.isShowMultiAction;\n    },\n\n    /**--------------------------------\r\n     * Thực hiện ẩn nút \"Xóa nhiều\".\r\n     * Author: quyetkaito (14/03/2022)\r\n     ---------------------------------*/\n    hideMultiAction() {\n      this.isShowMultiAction = false;\n    },\n\n    /**-------------------------------------\r\n     * Thực hiện delay call API khi tìm kiếm.\r\n     * Author: quyetkaito (15/03/2022)\r\n    ---------------------------------*/\n    lodashDelay: _.debounce(function () {\n      this.filterDataServer();\n    }, 1200),\n\n    /**--------------------------------\r\n     * Hàm gọi API tìm kiếm dữ liệu từ server.\r\n     * Author: quyetkaito (03/03/2022)\r\n     ----------------------------------*/\n    filterDataServer() {\n      let me = this;\n      me.loadData();\n    },\n\n    /**----------------------------------------\r\n     * Hàm thực hiện load data (đã phân trang) binding vào bảng.\r\n     * Author: quyetkaito (25/02/2022)\r\n     ------------------------------------------*/\n    async loadData() {\n      try {\n        let me = this; //không cho phân trang\n\n        me.disableComboboxPaging = true;\n        me.storeUser = []; // me.itemSelected = {};\n\n        me.formMode = 0;\n        if (!me.pageSize) me.pageSize = 10;\n        if (!me.pageNumber || me.pageNumber != 1) me.pageNumber = 1; //show loading\n\n        me.isShowSkeleton = true; //mã hóa dữ liệu truyền lên\n\n        let textFilter;\n\n        if (me.dataFilter) {\n          //var buf = new Buffer(b64string, 'base64');\n          debugger;\n          this.$commonFunc.convertToBase64(me.dataFilter); // const buff = Buffer.from(me.dataFilter);\n          // const base64 = buff.toString('base64');            \n        }\n\n        if (!textFilter) textFilter = \"\"; //gọi API lấy dữ liệu nhân viên\n\n        let res = await UserAPI.request(`${UserAPI.urlName}/filter`, \"get\");\n\n        if (res && res.data) {\n          if (res.data.Data && res.data.Data.length > 0) {\n            me.storeUser = res.data.Data;\n          }\n        }\n\n        me.isShowSkeleton = false;\n        me.disableComboboxPaging = false;\n      } catch (error) {\n        this.showDefaultErrorNotify();\n        this.isShowSkeleton = false;\n        console.error(error);\n      }\n    },\n\n    /**----------------------------------------------\r\n     * show thông báo lỗi mặc định cho người dùng.\r\n     * Author: quyetkaito (8/03/2022)\r\n     ------------------------------------------------*/\n    showDefaultErrorNotify() {\n      this.$store.commit(\"showError\", {\n        message: 'lỗi rồi'\n      });\n    },\n\n    /**-------------------------------\r\n     * Hàm xử lý exception api trả về.\r\n     * @param {Exception} error - exception từ api trả về\r\n     * Author: quyetkaito (08/03/2022)\r\n     ---------------------------------*/\n    handleException(error) {\n      let me = this;\n      let response = error.response;\n\n      if (response.status) {\n        switch (error.response.status) {\n          case this.$enum.StatusCode.InternalServerError:\n            {\n              if (response.data.userMsg) {\n                me.showPopup(this.$enum.PopupType.DataError, response.data.userMsg);\n              } else {\n                me.showDefaultErrorNotify();\n              }\n\n              break;\n            }\n\n          case this.$enum.StatusCode.BadRequest:\n            {\n              //400\n              //gán message vào popup\n              me.showDefaultErrorNotify();\n            }\n            break;\n\n          default:\n            break;\n        }\n      } else {\n        me.showDefaultErrorNotify();\n      }\n    },\n\n    /**----------------------------------\r\n     * Hàm gọi show popup (true).\r\n     * @param {Number} type: loại popup\r\n     * @param {String} text: nội dung popup \r\n     * Author: quyetkaito (24/02/2022)\r\n     ------------------------------------*/\n    showPopup(type, text) {\n      if (type) {\n        this.popupType = type;\n      }\n\n      if (text) {\n        this.popupText = text;\n      }\n\n      this.showMessagebox(true); //focus vào button đầu tiên(để đóng popup = phím Enter)\n\n      this.$refs.popup.focus();\n    },\n\n    /**---------------------------------\r\n     * Thực hiện show/hide messsagebox.\r\n     * @param {Boolean} isShow - true là hiện/ false là ẩn.\r\n     * Author: quyetkaito (25/02/2022)\r\n     -----------------------------------*/\n    showMessagebox(isShow) {\n      this.isShowPopup = isShow;\n    },\n\n    /**---------------------------------------------------------------\r\n     * Hàm thực hiện show table function Xóa/Nhân bản/ Ngừng sử dụng.\r\n     * @param {Object} object - đối tượng nhân viên.\r\n     * Author: quyetkaito (08/03/2022)\r\n     ----------------------------------------------------------------*/\n    showFunction(object) {\n      if (this.isShowFunc) {\n        this.isShowFunc = false;\n      } else {\n        this.isShowFunc = true;\n        this.itemSelected = object;\n        this.formMode = this.$enum.FormMode.Clone;\n      }\n    },\n\n    /**------------------------------------\r\n     * Hàm thực hiện hide table function.\r\n     * Author: quyetkaito (08/03/2022)\r\n     -------------------------------*/\n    hideFunction() {\n      this.isShowFunc = false;\n    },\n\n    /**--------------------------------------\r\n     * Hàm thực hiện cập nhật trang hiện tại.\r\n     * @param {Number} page - số thứ tự của trang (từ 1)\r\n     * Author: quyetkaito (03/03/2022)\r\n    ----------------------------------------*/\n    setCurrentPage(page) {\n      this.pageNumber = page; //thực hiện filter lại\n\n      this.filterDataServer(this.pageNumber);\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["_","vMultiselect","UserAPI","UserDetail","name","components","created","loadData","data","storeUser","isShowDialog","isShowPopup","isShowFunc","isShowMultiAction","isShowSkeleton","itemSelected","formMode","popupText","popupType","isMultiDelete","toastText","toastType","pagingOptions","label","value","disableComboboxPaging","pageNumber","pageSize","totalPage","totalEmp","dataFilter","multiDeleteText","columns","title","key","width","dataType","titleAlign","tableFunction","$enum","TableFunction","Clone","Delete","Stop","listEmployeeChecked","methods","handleGridAction","options","object","action","view","deleteObject","edit","buttonClick","me","add","$refs","userDialog","show","bindData","confirm","user_id","$commonFunc","load","request","urlName","then","res","console","log","unload","error","handleException","showToast","closeDialog","exportData","mLoading","tableInfos","listHeader","getitemSelected","listChecked","forEach","employee","push","employee_id","toggleMultiAction","hideMultiAction","lodashDelay","debounce","filterDataServer","textFilter","convertToBase64","Data","length","showDefaultErrorNotify","$store","commit","message","response","status","StatusCode","InternalServerError","userMsg","showPopup","PopupType","DataError","BadRequest","type","text","showMessagebox","popup","focus","isShow","showFunction","FormMode","hideFunction","setCurrentPage","page"],"sourceRoot":"","sources":["D:\\Traveller\\Traveller-Frontend\\traveller-ui\\src\\views\\user\\UserList.vue"],"sourcesContent":["<template>\r\n  <!-- Content riêng của trang Employee -->\r\n  <div class=\"content\">\r\n    <div class=\"employee-top\">\r\n      <div class=\"content-top\">\r\n        <div class=\"page-title\">{{ $t('UserManager') }}</div>\r\n        <m-button :text=\"$t('common.add_new')\" @click=\"buttonClick('Add')\" />\r\n      </div>\r\n    </div>\r\n    <div class=\"employee-bottom\">\r\n      <div class=\"content-bottom\">\r\n        <div class=\"filter-area flex\">\r\n          <!-- Xóa nhiều -->\r\n          <div class=\"flex align-x-y-center\">\r\n            <button class=\"m-btn-dropdown\">\r\n              <div class=\"m-btn-text text-dropdown\">Thực hiện hàng loạt</div>\r\n              <div class=\"m-icon m-icon-16 m-icon-dropdown\"></div>\r\n            </button>\r\n            <div\r\n              class=\"dropdown-button\"\r\n              v-if=\"isShowMultiAction && listEmployeeChecked.length > 0\"\r\n            >\r\n              <div class=\"m-dropdown-item\" @click=\"handleMultiDelete\">\r\n                {{ multiDeleteText }}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <!-- Các component filter dữ liệu -->\r\n          <div class=\"content-filter flex align-y-center justify-end\">\r\n            <!-- Input Search -->\r\n            <div style=\"width: 240px\">\r\n              <m-input\r\n                ref=\"searchInput\"\r\n                :showLabel=\"false\"\r\n                :maxlength=\"255\"\r\n                :width=\"240\"\r\n                :isHasIcon=\"true\"\r\n                v-model=\"dataFilter\"\r\n                placeholder=\"Tìm kiếm\"\r\n                @input=\"lodashDelay(value)\"\r\n                @findData=\"filterDataServer\"\r\n              />\r\n            </div>\r\n\r\n            <div style=\"position: relative\">\r\n              <div\r\n                title=\"Lấy lại dữ liệu\"\r\n                class=\"m-icon m-icon-24 m-refresh btn-refresh\"\r\n                @click=\"buttonClick('Refresh')\"\r\n              ></div>              \r\n            </div>\r\n            <div style=\"position: relative\">\r\n              <div\r\n              title=\"Xuất ra excel\"\r\n                class=\"m-icon m-icon-24 m-excel__nav btn-export\"\r\n                @click=\"exportData\"\r\n              ></div>              \r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Bảng -->\r\n        <div class=\"content-grid\">\r\n          <div class=\"table-container\">\r\n            <m-grid\r\n              ref=\"mygrid\"\r\n              :listData=\"storeUser\"\r\n              :columns=\"columns\"\r\n              :pageSize=\"pageSize\"\r\n              :isShowSkeleton=\"isShowSkeleton\"\r\n              functionText=\"Sửa\"\r\n              @eShowFunc=\"showFunction\"\r\n              @handleHideFunc=\"hideFunction\"\r\n              @eMultiSelect=\"getitemSelected\"\r\n              @eDoubleClick=\"view\"\r\n              @gridAction=\"handleGridAction\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Ảnh hiển thị nếu không có dữ liệu -->\r\n        <div\r\n          class=\"flex align-center\"\r\n          style=\"width: 100%; flex-direction: column\"\r\n          v-show=\"Object.keys(storeUser).length === 0 && dataFilter != ''\"\r\n        >\r\n          <img\r\n            src=\"@/assets/img/bg_report_nodata.76e50bd8.svg\"\r\n            alt=\"\"\r\n            width=\"100\"\r\n            height=\"100\"\r\n          />\r\n          <p style=\"margin: 0px; padding: 0px\">Không có dữ liệu</p>\r\n        </div>\r\n\r\n        <!-- Paging -->\r\n        <div class=\"m-paging\" v-show=\"Object.keys(storeUser).length !== 0\">\r\n          <div class=\"paging-left\">\r\n            <!-- <ms-table-counter :record=\"totalEmp\" /> -->\r\n          </div>\r\n          <div class=\"paging-right\">\r\n            <!-- Combobox Paging -->\r\n            <!-- <vue-select\r\n              ref=\"comboPaging\"\r\n              style=\"width: 200px !important\"\r\n              :options=\"pagingOptions\"\r\n              v-model=\"pageSize\"\r\n              :label-by=\"(pagingOptions) => pagingOptions.label\"\r\n              :value-by=\"(pagingOptions) => pagingOptions.value\"\r\n              placeholder=\"\"\r\n              close-on-select\r\n              :disabled=\"disableComboboxPaging\"\r\n            >\r\n            </vue-select> -->\r\n            <v-multiselect\r\n              ref=\"comboPaging\"\r\n              style=\"width: 250px !important\"\r\n              v-model=\"pageSize\"\r\n              :options=\"pagingOptions\"\r\n              label=\"label\"\r\n              :close-on-select=\"true\"\r\n              :clearOnSelect=\"true\"\r\n              :searchable=\"false\"\r\n              noResultsText=\"Không có dữ liệu hiển thị\"\r\n              :disabled=\"false\"\r\n              :canClear=\"false\"\r\n              :canDeselect=\"false\"\r\n              openDirection=\"top\"\r\n            />\r\n            <!-- Paging action -->\r\n            <!-- <m-pagination\r\n              :totalPage=\"totalPage\"\r\n              :currentPage=\"pageNumber\"\r\n              :pageSize=\"pageSize\"\r\n              @changeCurrentPage=\"setCurrentPage\"\r\n            /> -->\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <!-- <ms-employee-dialog\r\n      ref=\"addDialog\"\r\n      :isShow=\"isShowDialog\"\r\n      @showDialog=\"showEmployeeDialog(value)\"\r\n      @eCloseDialog=\"closeDialog\"\r\n      @loadData=\"loadData()\"\r\n      :itemSelected=\"itemSelected\"\r\n      :formMode=\"formMode\"\r\n    /> -->\r\n    <!-- <ms-popup\r\n      ref=\"popup\"\r\n      :popupType=\"popupType\"\r\n      :isShow=\"isShowPopup\"\r\n      :itemSelected=\"itemSelected\"\r\n      @showPopup=\"showMessagebox(isShow)\"\r\n      @deleteComfirm=\"deleteEmployee(itemSelected)\"\r\n      @multiDeleteConfirm=\"multiDeleteEmployee\"\r\n      :text=\"popupText\"\r\n      :isMultiDelete=\"isMultiDelete\"\r\n    />    -->\r\n\r\n    <!-- <ms-dropdown-content\r\n      ref=\"mTableFunction\"\r\n      directionY=\"right\"\r\n      :optionObjects=\"tableFunction\"\r\n      @eData=\"getValueFromDropdown\"\r\n    /> -->\r\n  </div>\r\n  <user-detail ref=\"userDialog\"/>\r\n</template>\r\n\r\n<script>\r\n//import Library\r\nimport _ from \"lodash\";\r\n// const FileDownload = require(\"js-file-download\");\r\n//multi vue 3\r\nimport vMultiselect from \"@vueform/multiselect\";\r\nimport \"@vueform/multiselect/themes/default.css\";\r\n\r\nimport UserAPI from \"@/api/UserAPI\";\r\nimport UserDetail from \"@/views/user/UserDetail.vue\";\r\n\r\nexport default {\r\n  name: \"EmployeeList\",\r\n  components: {\r\n    // \"ms-employee-dialog\": EmployeeDetail,\r\n    // \"ms-pagination\": MSPagination,\r\n    \"v-multiselect\": vMultiselect,\r\n    \"user-detail\": UserDetail\r\n  },\r\n  //   directives: {\r\n  //     clickOutside: vClickOutside.directive,\r\n  //   },\r\n\r\n  /**---------------------------\r\n   * Giai đoạn 2: có thể truy cập vào data, event, chưa truy cập dc DOM\r\n   -----------------------------*/\r\n  created() {\r\n    this.loadData();\r\n  },\r\n\r\n  /**--------------\r\n   * Data\r\n  -----------------*/\r\n  data() {\r\n    return {\r\n      storeUser: [], //danh sách mã giảm giá\r\n      isShowDialog: false, //dialog có hiện không?\r\n      isShowPopup: false, //popup có hiện không?\r\n\r\n      isShowFunc: false, //function của table có hiện không?\r\n      isShowMultiAction: false, //dropdown của thực hiện hàng loạt có hiện không?\r\n      isShowSkeleton: false, //có đang hiện skeleton ko?\r\n      itemSelected: {}, //đối tượng nhân viên đang được chọn để thao tác.\r\n      formMode: 0, //trạng thái form đang là gì?\r\n      //set text,type cho popup\r\n      popupText: null,\r\n      popupType: null,\r\n      isMultiDelete: false, //có đang xóa nhiều không?\r\n      //thông tin của toast\r\n      toastText: \"toast-text\",\r\n      toastType: 0,\r\n      //các option cho paging\r\n      pagingOptions: [\r\n        {\r\n          label: \"10 bản ghi trên 1 trang\",\r\n          value: 10,\r\n        },\r\n        {\r\n          label: \"20 bản ghi trên 1 trang\",\r\n          value: 20,\r\n        },\r\n        {\r\n          label: \"30 bản ghi trên 1 trang\",\r\n          value: 30,\r\n        },\r\n        {\r\n          label: \"50 bản ghi trên 1 trang\",\r\n          value: 50,\r\n        },\r\n        {\r\n          label: \"100 bản ghi trên 1 trang\",\r\n          value: 100,\r\n        },\r\n      ],\r\n      disableComboboxPaging: false,\r\n      pageNumber: 1, //trang số bao nhiêu\r\n      pageSize: 10, //số bản ghi trên 1 trang\r\n      totalPage: null, //tổng số trang\r\n      totalEmp: null, //tổng số bản ghi dữ liệu\r\n      dataFilter: \"\", //giá trị để tìm kiếm\r\n      multiDeleteText: \"Xóa\",\r\n      //thông tin khởi tạo table\r\n      //danh sách các tiêu đề và fieldName của bảng\r\n      columns: [\r\n        {\r\n          title: \"Họ và tên\",\r\n          key: \"full_name\",\r\n          width: 200,\r\n        },\r\n        {\r\n          title: \"email\",\r\n          key: \"email\",\r\n          width: 200,\r\n        },\r\n        {\r\n          title: \"Ngày sinh\",\r\n          key: \"date_of_birth\",\r\n          width: 200,\r\n          dataType: \"date\",\r\n          titleAlign: \"center\",\r\n        },\r\n        {\r\n          title: \"Tên đăng nhập\",\r\n          key: \"username\",                    \r\n          width: 200,\r\n        },\r\n        {\r\n          title: \"Số điện thoại\",\r\n          key: \"phone\",\r\n          width: 150,\r\n          titleAlign: \"left\",\r\n        }       \r\n      ],\r\n      //các function của table\r\n      tableFunction: [\r\n        {\r\n          title: \"Nhân bản\",\r\n          value: this.$enum.TableFunction.Clone,\r\n        },\r\n        {\r\n          title: \"Xóa\",\r\n          value: this.$enum.TableFunction.Delete,\r\n        },\r\n        {\r\n          title: \"Ngừng sử dụng\",\r\n          value: this.$enum.TableFunction.Stop,\r\n        },\r\n      ],\r\n      listEmployeeChecked: [],\r\n    };\r\n  },\r\n\r\n  /**-----------------\r\n   * Các phương thức\r\n   -------------------*/\r\n  methods: {\r\n    /**\r\n    * Hàm nhận sự kiện gửi từ grid ra\r\n    * @created : quyetkaito 07/10/2022\r\n    */\r\n    handleGridAction(options){\r\n        if(options){\r\n            if(options.object){\r\n                if(options.action == 'View'){\r\n                    this.view(options.object);\r\n                }\r\n                else if(options.action == 'Delete'){\r\n                    this.deleteObject(options.object);\r\n                }\r\n                else if(options.action == 'Edit'){\r\n                    this.edit(options.object);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /**\r\n    * Hàm xử lý sự kiện cho các button trên màn hình\r\n    * @created : quyetkaito 04/10/2022\r\n    * @param {string} action : tên hành đông\r\n    */\r\n    buttonClick(action){\r\n        if(!action) return;\r\n        let me = this;\r\n        switch(action){\r\n            case 'Add':\r\n                me.add();\r\n                break;\r\n            case 'Edit':\r\n                me.edit();\r\n                break;\r\n            case 'View':\r\n                me.view();\r\n                break;\r\n            case 'Refresh':\r\n                me.loadData();\r\n                break;\r\n            default: \r\n            break;\r\n        }\r\n    },\r\n\r\n    view(object){\r\n        if(object){\r\n            let me = this;            \r\n            if(me.$refs.userDialog && typeof me.$refs.userDialog.show == \"function\"){\r\n                me.$refs.userDialog.show();\r\n                //bắn dữ liệu lên form\r\n                if(typeof me.$refs.userDialog.bindData == \"function\"){\r\n                    me.$refs.userDialog.bindData(object, 'View');                    \r\n                }\r\n            }           \r\n        }\r\n    },\r\n\r\n    /**\r\n    * Hàm xử lý sửa đối tượng\r\n    * @created : quyetkaito 06/10/2022\r\n    */\r\n    edit(object){\r\n        if(object){\r\n            let me = this;            \r\n            if(me.$refs.userDialog && typeof me.$refs.userDialog.show == \"function\"){\r\n                me.$refs.userDialog.show();\r\n                //bắn dữ liệu lên form\r\n                if(typeof me.$refs.userDialog.bindData == \"function\"){\r\n                    me.$refs.userDialog.bindData(object, 'Edit');                    \r\n                }\r\n            }           \r\n        }\r\n    },\r\n\r\n    /**\r\n    * hàm xử lý xóa đối tượng\r\n    * @created : quyetkaito 07/10/2022\r\n    */\r\n    async deleteObject(object){\r\n        if(object){\r\n            //cảnh báo có thực sự muốn xóa không\r\n            let me = this;\r\n            if(confirm(\"bạn có thực sự muốn xóa ko\")){\r\n                if(object.user_id){\r\n                    me.$commonFunc.load();\r\n                    try {\r\n                        await UserAPI.request(`${UserAPI.urlName}/${object.user_id}`, 'DELETE').then(res=>{\r\n                            console.log(`res`, res);\r\n                            me.$commonFunc.unload();\r\n                            me.buttonClick('Refresh');\r\n                        })        \r\n                    } catch (error) {\r\n                        me.handleException(error);\r\n                    }                    \r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n    * Hàm xử lý thêm mới đối tượng\r\n    * @created : quyetkaito 04/10/2022\r\n    */\r\n    add(){  \r\n        //mở form\r\n        let me = this;\r\n        if(me.$refs.userDialog && typeof me.$refs.userDialog.show == \"function\"){\r\n            me.$refs.userDialog.show('Add');\r\n        }\r\n        //khởi tạo dữ liệu ban đầu\r\n    },\r\n\r\n    showToast() {\r\n        //show toast\r\n        //   this.$store.commit(\"showError\", {\r\n        //     message: \"Lỗi rồi em ei\",\r\n        //   });\r\n        // this.$store.commit(\"setLang\", \"en\");\r\n        //thay đổi ngôn ngữ\r\n        // this.$i18n.changeLocale('en');\r\n\r\n    },\r\n\r\n    /**--------------------------\r\n     * Hàm thực hiện đóng dialog nhân viên.\r\n     * Author: quyetnv(22/03/2022)\r\n     -----------------------------*/\r\n    closeDialog() {\r\n      this.itemSelected = {};\r\n      this.formMode = 0;\r\n      this.isShowDialog = false;\r\n    },\r\n\r\n    /**----------------------------------\r\n     * Hàm gọi API xuất dữ liệu.\r\n     * Author: quyetkaito (15/03/2022)\r\n    -------------------------------*/\r\n    exportData() {\r\n      let me = this;\r\n      me.$refs.mLoading.show();\r\n      let object = {};\r\n      object.tableInfos = me.listHeader;\r\n      object.dataFilter = me.dataFilter;\r\n      //gửi lên server danh sách các header\r\n    //   axios\r\n    //     .post(`${LOCAL_EMPLOYEE_API_URL}/export`, object, {\r\n    //       responseType: \"blob\",\r\n    //     })\r\n    //     .then((response) => {\r\n    //       FileDownload(response.data, \"Danh_sach_nhan_vien.xlsx\");\r\n    //       me.$refs.mLoading.hide();\r\n    //     })\r\n    //     .catch(() => {\r\n    //       me.$refs.mLoading.hide();\r\n    //     });\r\n    },\r\n\r\n    /**--------------------------------------\r\n     * Xử lý khi nút [Xóa hàng loạt] được chọn\r\n     * Author: quyetkaito (14/03/2022)\r\n    ----------------------------------*/\r\n    // handleMultiDelete() {\r\n    //   this.isMultiDelete = true;\r\n    //   //show cảnh báo xóa nhiều\r\n    //   this.showPopup(this.$enum.PopupType.DataDelete);\r\n    // },\r\n\r\n    /**----------------------------\r\n     * Thực hiện gọi API xóa nhiều.\r\n     * Author: quyetkaito (14/03/2022)\r\n     ------------------------------*/\r\n    // multiDeleteEmployee() {\r\n    //   let me = this;\r\n    //   //hiện loading\r\n    //   me.$refs.mLoading.show();\r\n    //   //gọi API xóa nhiều\r\n    //   axios\r\n    //     .delete(`${LOCAL_EMPLOYEE_API_URL}`, { data: me.listEmployeeChecked })\r\n    //     .then(() => {\r\n    //       //đóng popup\r\n    //       me.showMessagebox(false);\r\n    //       //thông báo thành công\r\n    //     //   me.toastText = Resource.SuccessDelete;\r\n    //       me.$refs.msToast.show();\r\n    //       //reset lại danh sách employee được chọn\r\n    //       me.listEmployeeChecked = [];\r\n    //       me.isMultiDelete = false;\r\n    //       //ẩn loading\r\n    //       me.$refs.mLoading.hide();\r\n\r\n    //       //load lại dữ liệu\r\n    //       me.loadData();\r\n    //       //bỏ dấu check all\r\n    //       this.$refs.mygrid.unCheckAll();\r\n    //     })\r\n    //     .catch((error) => {\r\n    //       me.handleException(error);\r\n    //       //reset lại danh sách employee được chọn\r\n    //       me.listEmployeeChecked = [];\r\n    //       me.isMultiDelete = false;\r\n    //       me.$refs.mLoading.hide();\r\n    //     });\r\n    // },\r\n\r\n    /**-----------------------------------------------------\r\n     * Lấy danh sách id của các employee được chọn từ bảng.\r\n     * @param {Array} listChecked - mảng các đối tượng nhân viên được chọn.\r\n     * Author: quyetkaito (14/03/2022)\r\n     -------------------------------------------------------*/\r\n    getitemSelected(listChecked) {\r\n      try {\r\n        //lấy ra id của đối tượng\r\n        listChecked.forEach((employee) => {\r\n          //push vào mảng các id của nhân viên\r\n          this.listEmployeeChecked.push(employee.employee_id);\r\n        });\r\n      } catch (error) {\r\n        //log ra lỗi\r\n        console.error(error);\r\n      }\r\n    },\r\n\r\n    /**-----------------------------------\r\n     * Thực hiện ẩn/ hiện nút \"Xóa nhiều\".\r\n     * Author: quyetkaito (14/03/2022)\r\n     -------------------------------------*/\r\n    toggleMultiAction() {\r\n      this.isShowMultiAction = !this.isShowMultiAction;\r\n    },\r\n\r\n    /**--------------------------------\r\n     * Thực hiện ẩn nút \"Xóa nhiều\".\r\n     * Author: quyetkaito (14/03/2022)\r\n     ---------------------------------*/\r\n    hideMultiAction() {\r\n      this.isShowMultiAction = false;\r\n    },\r\n\r\n    /**-------------------------------------\r\n     * Thực hiện delay call API khi tìm kiếm.\r\n     * Author: quyetkaito (15/03/2022)\r\n    ---------------------------------*/\r\n    lodashDelay: _.debounce(function () {\r\n      this.filterDataServer();\r\n    }, 1200),\r\n\r\n    /**--------------------------------\r\n     * Hàm gọi API tìm kiếm dữ liệu từ server.\r\n     * Author: quyetkaito (03/03/2022)\r\n     ----------------------------------*/\r\n    filterDataServer() {\r\n      let me = this;    \r\n      me.loadData();\r\n    },\r\n\r\n    /**----------------------------------------\r\n     * Hàm thực hiện load data (đã phân trang) binding vào bảng.\r\n     * Author: quyetkaito (25/02/2022)\r\n     ------------------------------------------*/\r\n    async loadData() {\r\n      try {\r\n        let me = this;\r\n        //không cho phân trang\r\n        me.disableComboboxPaging = true;        \r\n        me.storeUser = [];\r\n        // me.itemSelected = {};\r\n        me.formMode = 0;\r\n        if (!me.pageSize) me.pageSize = 10;\r\n        if (!me.pageNumber || me.pageNumber != 1) me.pageNumber = 1;\r\n        //show loading\r\n        me.isShowSkeleton = true;\r\n        //mã hóa dữ liệu truyền lên\r\n        let textFilter;\r\n        if(me.dataFilter){\r\n            //var buf = new Buffer(b64string, 'base64');\r\n            debugger\r\n            this.$commonFunc.convertToBase64(me.dataFilter);\r\n            // const buff = Buffer.from(me.dataFilter);\r\n            // const base64 = buff.toString('base64');            \r\n        }\r\n        if(!textFilter) textFilter=\"\";\r\n        //gọi API lấy dữ liệu nhân viên\r\n        let res = await UserAPI.request(`${UserAPI.urlName}/filter`,\"get\");\r\n        if(res && res.data){            \r\n            if(res.data.Data && res.data.Data.length >0){\r\n                me.storeUser = res.data.Data;\r\n            }\r\n        }\r\n        me.isShowSkeleton = false;\r\n        me.disableComboboxPaging = false;        \r\n          \r\n      } catch (error) {\r\n        this.showDefaultErrorNotify();\r\n        this.isShowSkeleton = false;\r\n        console.error(error);\r\n      }\r\n    },\r\n\r\n    /**----------------------------------------------\r\n     * show thông báo lỗi mặc định cho người dùng.\r\n     * Author: quyetkaito (8/03/2022)\r\n     ------------------------------------------------*/\r\n    showDefaultErrorNotify() {\r\n      this.$store.commit(\"showError\",{\r\n        message: 'lỗi rồi'\r\n        });\r\n    },\r\n\r\n    /**-------------------------------\r\n     * Hàm xử lý exception api trả về.\r\n     * @param {Exception} error - exception từ api trả về\r\n     * Author: quyetkaito (08/03/2022)\r\n     ---------------------------------*/\r\n    handleException(error) {\r\n      let me = this;\r\n      let response = error.response;\r\n      if (response.status) {\r\n        switch (error.response.status) {\r\n          case this.$enum.StatusCode.InternalServerError: {\r\n            if (response.data.userMsg) {\r\n              me.showPopup(\r\n                this.$enum.PopupType.DataError,\r\n                response.data.userMsg\r\n              );\r\n            } else {\r\n              me.showDefaultErrorNotify();\r\n            }\r\n            break;\r\n          }\r\n          case this.$enum.StatusCode.BadRequest:\r\n            {\r\n              //400\r\n              //gán message vào popup\r\n              me.showDefaultErrorNotify();\r\n            }\r\n            break;\r\n\r\n          default:\r\n            break;\r\n        }\r\n      } else {\r\n        me.showDefaultErrorNotify();\r\n      }\r\n    },\r\n\r\n    /**----------------------------------\r\n     * Hàm gọi show popup (true).\r\n     * @param {Number} type: loại popup\r\n     * @param {String} text: nội dung popup \r\n     * Author: quyetkaito (24/02/2022)\r\n     ------------------------------------*/\r\n    showPopup(type, text) {\r\n      if (type) {\r\n        this.popupType = type;\r\n      }\r\n      if (text) {\r\n        this.popupText = text;\r\n      }\r\n      this.showMessagebox(true);\r\n      //focus vào button đầu tiên(để đóng popup = phím Enter)\r\n      this.$refs.popup.focus();\r\n    },\r\n\r\n    /**---------------------------------\r\n     * Thực hiện show/hide messsagebox.\r\n     * @param {Boolean} isShow - true là hiện/ false là ẩn.\r\n     * Author: quyetkaito (25/02/2022)\r\n     -----------------------------------*/\r\n    showMessagebox(isShow) {\r\n      this.isShowPopup = isShow;\r\n    },\r\n\r\n    /**---------------------------------------------------------------\r\n     * Hàm thực hiện show table function Xóa/Nhân bản/ Ngừng sử dụng.\r\n     * @param {Object} object - đối tượng nhân viên.\r\n     * Author: quyetkaito (08/03/2022)\r\n     ----------------------------------------------------------------*/\r\n    showFunction(object) {\r\n      if (this.isShowFunc) {\r\n        this.isShowFunc = false;\r\n      } else {\r\n        this.isShowFunc = true;\r\n        this.itemSelected = object;\r\n        this.formMode = this.$enum.FormMode.Clone;\r\n      }\r\n    },\r\n\r\n    /**------------------------------------\r\n     * Hàm thực hiện hide table function.\r\n     * Author: quyetkaito (08/03/2022)\r\n     -------------------------------*/\r\n    hideFunction() {\r\n      this.isShowFunc = false;\r\n    },\r\n\r\n\r\n    /**--------------------------------------\r\n     * Hàm thực hiện cập nhật trang hiện tại.\r\n     * @param {Number} page - số thứ tự của trang (từ 1)\r\n     * Author: quyetkaito (03/03/2022)\r\n    ----------------------------------------*/\r\n    setCurrentPage(page) {\r\n      this.pageNumber = page;\r\n      //thực hiện filter lại\r\n      this.filterDataServer(this.pageNumber);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n@import url(\"/src/style/page/employee.css\");\r\n@import url(\"/src/style/page/base-page.css\");\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}