{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\nimport CategoryAPI from \"@/api/CategoryAPI\"; //multi vue 3\n\nimport vMultiselect from \"@vueform/multiselect\";\nimport \"@vueform/multiselect/themes/default.css\"; //lodash\n\nimport _ from \"lodash\"; //\n\nimport CategoryDetail from \"@/views/category/CategoryDetail.vue\";\nexport default {\n  components: {\n    // \"v-multiselect\": vMultiselect,\n    \"category-detail\": CategoryDetail\n  },\n\n  data() {\n    return {\n      storeCategory: [],\n      //dữ liệu danh mục\n      pageSize: 10,\n      dataFilter: '',\n      isShowSkeleton: false,\n      selected: 0,\n      storeAll: [],\n      totalPage: 0,\n      pageNumber: 1\n    };\n  },\n\n  created() {\n    this.initStaticData();\n    this.loadData();\n  },\n\n  methods: {\n    initStaticData() {\n      this.columns = [{\n        title: 'Tên danh mục',\n        key: 'category_name',\n        titleAlign: 'left'\n      }];\n      this.tableFunction = {\n        isShow: true,\n        viewButton: false,\n        editButton: true,\n        deleteButton: true\n      };\n    },\n\n    async loadData() {\n      let me = this;\n\n      try {\n        // me.$commonFunc.load();\n        this.isShowSkeleton = true;\n        this.storeCategory = [];\n        let res = await CategoryAPI.request(CategoryAPI.urlName, 'GET');\n\n        if (res && res.data) {\n          this.storeCategory = JSON.parse(JSON.stringify(res.data));\n          this.storeAll = JSON.parse(JSON.stringify(res.data));\n          this.totalPage = Math.round(res.data.length / 10);\n        }\n\n        this.isShowSkeleton = false; // me.$commonFunc.unload();\n      } catch (error) {\n        console.error(error);\n      }\n    },\n\n    setCurrentPage(page) {\n      if (this.pageNumber == page) return;\n      this.pageNumber = page; //thực hiện filter lại\n      // this.filterDataServer(this.pageNumber);\n    },\n\n    handleGridAction(options) {\n      if (options) {\n        if (options.object) {\n          if (options.action == 'View') {// this.view(options.object);\n          } else if (options.action == 'Delete') {\n            this.deleteObject(options.object);\n          } else if (options.action == 'Edit') {\n            this.edit(options.object);\n          }\n        }\n      }\n    },\n\n    getItemSelected(selectedRow) {\n      if (selectedRow && selectedRow.length > 0) {\n        this.selected = selectedRow.length;\n      } else {\n        this.selected = 0;\n      }\n    },\n\n    hideFunction() {},\n\n    showFunction() {},\n\n    lodashDelay: _.debounce(function () {\n      this.filterData();\n    }, 1200),\n\n    async filterData() {\n      //hiện tại chỉ đáp ứng filter local do dữ liệu ít\n      let me = this;\n      me.isShowSkeleton = true;\n      me.storeCategory = await me.storeAll.filter(x => x.category_name.toLowerCase().includes(this.dataFilter.toLowerCase()));\n      me.isShowSkeleton = false;\n    },\n\n    view() {},\n\n    buttonClick(action) {\n      switch (action) {\n        case 'Add':\n          this.openCategoryDetail();\n          break;\n\n        default:\n          break;\n      }\n    },\n\n    openCategoryDetail() {\n      this.$refs.categoryDetail.show();\n    },\n\n    edit(object) {\n      this.$refs.categoryDetail.showEdit(object);\n    },\n\n    async deleteObject(object) {\n      let me = this;\n\n      if (object && object.category_id) {\n        if (confirm(this.$t('message.delete_confirm'))) {\n          try {\n            me.$commonFunc.load();\n            let res = await CategoryAPI.request(CategoryAPI.urlName, 'DELETE', [object.category_id]);\n\n            if (res && res.data) {\n              if (res.data.StatusCode == 200) {\n                me.$store.commit(\"showSuccess\", {\n                  message: me.$t('message.success_delete')\n                });\n                me.loadData();\n              } else {\n                me.$store.commit(\"showError\", {\n                  message: res.data.DevMsg\n                });\n                console.log(res.data.DevMsg);\n              }\n            }\n\n            me.$commonFunc.unload();\n          } catch (error) {\n            me.$store.commit(\"showError\", {\n              message: me.$t('common.error_message')\n            });\n            console.error(error);\n            me.$commonFunc.unload();\n          }\n        }\n      }\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["CategoryAPI","vMultiselect","_","CategoryDetail","components","data","storeCategory","pageSize","dataFilter","isShowSkeleton","selected","storeAll","totalPage","pageNumber","created","initStaticData","loadData","methods","columns","title","key","titleAlign","tableFunction","isShow","viewButton","editButton","deleteButton","me","res","request","urlName","JSON","parse","stringify","Math","round","length","error","console","setCurrentPage","page","handleGridAction","options","object","action","deleteObject","edit","getItemSelected","selectedRow","hideFunction","showFunction","lodashDelay","debounce","filterData","filter","x","category_name","toLowerCase","includes","view","buttonClick","openCategoryDetail","$refs","categoryDetail","show","showEdit","category_id","confirm","$t","$commonFunc","load","StatusCode","$store","commit","message","DevMsg","log","unload"],"sourceRoot":"","sources":["D:\\Traveller\\Traveller-Frontend\\traveller-ui\\src\\views\\category\\CategoryList.vue"],"sourcesContent":["<template>\r\n  <!-- Content riêng của trang Employee -->\r\n  <div class=\"content\">\r\n    <div class=\"content-top-container\">\r\n      <div class=\"content-top\">\r\n        <div class=\"page-title\">{{ $t('category.CategoryManager') }}</div>\r\n        <m-button :text=\"$t('common.add_new')\" @click=\"buttonClick('Add')\" />\r\n      </div>\r\n    </div>\r\n    <div class=\"\">\r\n      <div class=\"content-bottom\">\r\n        <div class=\"filter-area flex\">\r\n          <!-- Xóa nhiều -->\r\n          <div class=\"flex align-center\" v-if=\"selected >= 1\">\r\n            <button class=\"m-btn-dropdown\" disabled :class=\"{'disabled' : selected < 1}\">\r\n              <div class=\"m-btn-text text-dropdown\">Xóa hàng loạt</div>\r\n            </button>           \r\n          </div>\r\n          <!-- Các component filter dữ liệu -->\r\n          <div class=\"content-filter flex align-y-center justify-center\">\r\n            <!-- Input Search -->\r\n            <div style=\"width: 240px\">\r\n              <m-input\r\n                ref=\"searchInput\"\r\n                :showLabel=\"false\"\r\n                :maxlength=\"255\"\r\n                :width=\"240\"\r\n                v-model=\"dataFilter\"\r\n                placeholder=\"Tìm kiếm\"\r\n                @input=\"lodashDelay(value)\"\r\n                @findData=\"filterData\"\r\n              />\r\n            </div>\r\n\r\n            <div style=\"position: relative\">\r\n              <div\r\n                title=\"Lấy lại dữ liệu\"\r\n                class=\"m-icon m-icon-24 m-refresh btn-refresh\"\r\n                @click=\"loadData\"\r\n              ></div>              \r\n            </div>            \r\n          </div>\r\n        </div>\r\n\r\n        <!-- Bảng -->\r\n        <div class=\"content-grid\">\r\n          <div class=\"table-container\">\r\n            <m-grid\r\n              ref=\"mygrid\"\r\n              :listData=\"storeCategory\"\r\n              :columns=\"columns\"\r\n              :pageSize=\"pageSize\"\r\n              :isShowSkeleton=\"isShowSkeleton\"\r\n              functionText=\"Sửa\"\r\n              @eShowFunc=\"showFunction\"\r\n              @handleHideFunc=\"hideFunction\"\r\n              @eMultiSelect=\"getItemSelected\"\r\n              @eDoubleClick=\"edit\"\r\n              @gridAction=\"handleGridAction\"\r\n              :tableFunction=\"tableFunction\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Ảnh hiển thị nếu không có dữ liệu -->\r\n        <div\r\n          class=\"flex align-center\"\r\n          style=\"width: 100%; flex-direction: column\"\r\n          v-show=\"Object.keys(storeCategory).length === 0 && dataFilter != ''\"\r\n        >\r\n          <img\r\n            src=\"@/assets/img/bg_report_nodata.76e50bd8.svg\"\r\n            alt=\"\"\r\n            width=\"100\"\r\n            height=\"100\"\r\n          />\r\n          <p style=\"margin: 0px; padding: 0px\">Không có dữ liệu </p>\r\n        </div>\r\n\r\n        <!-- Paging -->\r\n        <div class=\"m-paging\" v-show=\"Object.keys(storeCategory).length !== 0\">\r\n          <div class=\"paging-left\">\r\n            <!-- Paging action -->\r\n            <m-pagination\r\n              :totalPage=\"totalPage\"\r\n              :currentPage=\"pageNumber\"\r\n              :pageSize=\"pageSize\"\r\n              @changeCurrentPage=\"setCurrentPage\"\r\n            />\r\n          </div>\r\n          <div class=\"paging-right\">\r\n            <!-- <v-multiselect\r\n              ref=\"comboPaging\"\r\n              style=\"width: 250px !important\"\r\n              v-model=\"pageSize\"\r\n              :options=\"$commonConfig.pagingOptions\"\r\n              label=\"label\"\r\n              :close-on-select=\"true\"\r\n              :clearOnSelect=\"true\"\r\n              :searchable=\"false\"\r\n              noResultsText=\"Không có dữ liệu hiển thị\"\r\n              :disabled=\"false\"\r\n              :canClear=\"false\"\r\n              :canDeselect=\"false\"\r\n              openDirection=\"top\"\r\n            /> -->\r\n            \r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <category-detail ref=\"categoryDetail\"/>\r\n</template>\r\n\r\n<script>\r\nimport CategoryAPI from \"@/api/CategoryAPI\";\r\n//multi vue 3\r\nimport vMultiselect from \"@vueform/multiselect\";\r\nimport \"@vueform/multiselect/themes/default.css\";\r\n//lodash\r\nimport _ from \"lodash\";\r\n//\r\nimport CategoryDetail from \"@/views/category/CategoryDetail.vue\";\r\n\r\nexport default {\r\n  components :{\r\n      // \"v-multiselect\": vMultiselect,\r\n      \"category-detail\": CategoryDetail,\r\n  },\r\n  data() {\r\n    return {\r\n        storeCategory: [], //dữ liệu danh mục\r\n        pageSize:10 ,\r\n        dataFilter: '',\r\n        isShowSkeleton: false,     \r\n        selected: 0,  \r\n        storeAll: [], \r\n        totalPage: 0,\r\n        pageNumber: 1,        \r\n    }\r\n  },\r\n  created(){\r\n      this.initStaticData();\r\n      this.loadData();\r\n  },\r\n  methods:{\r\n    initStaticData(){\r\n      this.columns = [\r\n          {\r\n            title: 'Tên danh mục',            \r\n            key: 'category_name',\r\n            titleAlign: 'left',            \r\n          },          \r\n      ];\r\n      this.tableFunction = {          \r\n          isShow: true,\r\n          viewButton: false,\r\n          editButton: true,\r\n          deleteButton: true,\r\n      }\r\n    },\r\n    async loadData(){\r\n        let me = this;\r\n        try {\r\n          // me.$commonFunc.load();\r\n          this.isShowSkeleton = true;\r\n          this.storeCategory = [];\r\n          let res = await CategoryAPI.request(CategoryAPI.urlName, 'GET');\r\n          if(res && res.data){\r\n              this.storeCategory = JSON.parse(JSON.stringify(res.data));\r\n              this.storeAll = JSON.parse(JSON.stringify(res.data));  \r\n              this.totalPage = Math.round(res.data.length/10);      \r\n          }\r\n          this.isShowSkeleton = false;\r\n          // me.$commonFunc.unload();\r\n        } catch (error) {\r\n          console.error(error);\r\n        }\r\n    },\r\n\r\n    setCurrentPage(page){\r\n      if(this.pageNumber == page) return;\r\n       this.pageNumber = page;\r\n      //thực hiện filter lại\r\n      // this.filterDataServer(this.pageNumber);\r\n    },\r\n\r\n    handleGridAction(options){\r\n       if(options){\r\n            if(options.object){\r\n                if(options.action == 'View'){\r\n                    // this.view(options.object);\r\n                }\r\n                else if(options.action == 'Delete'){\r\n                  this.deleteObject(options.object);\r\n                }\r\n                else if(options.action == 'Edit'){\r\n                    this.edit(options.object);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    getItemSelected(selectedRow){\r\n        if(selectedRow && selectedRow.length > 0){\r\n            this.selected = selectedRow.length;\r\n        }else{\r\n          this.selected = 0;\r\n        }\r\n    },\r\n    hideFunction(){\r\n\r\n    },\r\n    showFunction(){\r\n\r\n    },\r\n\r\n    lodashDelay: _.debounce(function () {\r\n      this.filterData();\r\n    }, 1200),\r\n\r\n    async filterData(){\r\n        //hiện tại chỉ đáp ứng filter local do dữ liệu ít\r\n        let me = this;\r\n        me.isShowSkeleton = true;\r\n        me.storeCategory = await me.storeAll.filter(x=>x.category_name.toLowerCase().includes(this.dataFilter.toLowerCase()));\r\n        me.isShowSkeleton = false;\r\n    },\r\n    view(){\r\n\r\n    },\r\n    buttonClick(action){\r\n        switch (action) {\r\n          case 'Add':\r\n            this.openCategoryDetail();\r\n            break;\r\n        \r\n          default:\r\n            break;\r\n        }\r\n    },\r\n\r\n    openCategoryDetail(){\r\n      this.$refs.categoryDetail.show();\r\n    },\r\n\r\n    edit(object){\r\n      this.$refs.categoryDetail.showEdit(object);\r\n    },\r\n\r\n    async deleteObject(object){\r\n      let me = this;\r\n      if(object && object.category_id){\r\n          if(confirm(this.$t('message.delete_confirm'))){\r\n            try {\r\n              me.$commonFunc.load();\r\n              let res = await CategoryAPI.request(CategoryAPI.urlName, 'DELETE', [object.category_id]);\r\n              if(res && res.data){\r\n               if(res.data.StatusCode == 200){\r\n                 me.$store.commit(\"showSuccess\", {message: me.$t('message.success_delete')});\r\n                 me.loadData();\r\n               }else{  \r\n                  me.$store.commit(\"showError\", {message: res.data.DevMsg});\r\n                  console.log(res.data.DevMsg);\r\n               }\r\n              }             \r\n              me.$commonFunc.unload();\r\n            } catch (error) {\r\n              me.$store.commit(\"showError\", {message: me.$t('common.error_message')});\r\n              console.error(error);\r\n              me.$commonFunc.unload();     \r\n            }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n@import url(\"/src/style/page/base-page.css\");\r\n</style>"]},"metadata":{},"sourceType":"module"}